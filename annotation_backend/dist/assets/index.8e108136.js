var je=Object.defineProperty,Fe=Object.defineProperties;var Pe=Object.getOwnPropertyDescriptors;var pe=Object.getOwnPropertySymbols;var Le=Object.prototype.hasOwnProperty,We=Object.prototype.propertyIsEnumerable;var me=(e,t,s)=>t in e?je(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,z=(e,t)=>{for(var s in t||(t={}))Le.call(t,s)&&me(e,s,t[s]);if(pe)for(var s of pe(t))We.call(t,s)&&me(e,s,t[s]);return e},le=(e,t)=>Fe(e,Pe(t));import{o as u,c as D,a as ge,E as ye,d as N,r,b,w as n,e as _,f as o,g as V,F as B,h as p,i as Se,_ as oe,D as Be,t as I,j as Te,u as be,m as Ae,s as Ve,k as xe,l as Oe,p as H,n as K,q as ie,v as ne,x as re,y as L,z as Ee,A as R,B as Ne,C as ae,G as ze,H as Ue,I as Me,J as Re,K as De,L as we,M as ve,N as Qe,O as qe,P as Ge,Q as Je,R as He,S as Ke,V as Xe,T as Ye,U as Ze,W as et,X as tt}from"./vendor.6917b0f8.js";const ot=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))l(c);new MutationObserver(c=>{for(const i of c)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&l(a)}).observe(document,{childList:!0,subtree:!0});function s(c){const i={};return c.integrity&&(i.integrity=c.integrity),c.referrerpolicy&&(i.referrerPolicy=c.referrerpolicy),c.crossorigin==="use-credentials"?i.credentials="include":c.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function l(c){if(c.ep)return;c.ep=!0;const i=s(c);fetch(c.href,i)}};ot();var C=(e,t)=>{const s=e.__vccOpts||e;for(const[l,c]of t)s[l]=c;return s};const nt={name:"HomePage",components:{}},rt={style:{"text-align":"center"}};function lt(e,t,s,l,c,i){return u(),D("h1",rt,"Home page of HILT Demo")}var st=C(nt,[["render",lt]]);const E={1:"Sequence Classification",2:"Relation Extraction"},M={0:{name:"Neutral",colors:[{"background-color":"#FFFFFF",color:"#000000"},{"background-color":"#FFFFFF",color:"#000000"},{"background-color":"#FFFFFF",color:"#000000"},{"background-color":"#FFFFFF",color:"#000000"},{"background-color":"#FFFFFF",color:"#000000"}]},1:{name:"Red",colors:[{"background-color":"#EA9999",color:"#000000"},{"background-color":"#E06666",color:"#FFFFFF"},{"background-color":"#CC0000",color:"#FFFFFF"}]},2:{name:"Blue",colors:[{"background-color":"#ADD8E6",color:"#000000"},{"background-color":"#4682B4",color:"#000000"},{"background-color":"#00008B",color:"#FFFFFF"}]},3:{name:"Green",colors:[{"background-color":"#8AFF8A",color:"#000000"},{"background-color":"#00D100",color:"#FFFFFF"},{"background-color":"#007500",color:"#FFFFFF"}]},4:{name:"Purple",colors:[{"background-color":"#CC85FF",color:"#000000"},{"background-color":"#7700CC",color:"#FFFFFF"},{"background-color":"#3E006B",color:"#FFFFFF"}]},5:{name:"Orange",colors:[{"background-color":"#FFCA8A",color:"#000000"},{"background-color":"#FFA12E",color:"#000000"},{"background-color":"#D67600",color:"#000000"}]}};ge.defaults.baseURL="/api";const k=ge.create({headers:{Accept:"application/json","Content-Type":"application/json",Authorization:null}});k.interceptors.response.use(e=>e.data,e=>(ye({title:"Error",message:e.toString(),type:"error"}),Promise.reject(e)));k.interceptors.request.use(e=>e,e=>(ye({title:"Error",message:e.toString(),type:"error"}),Promise.reject(e)));var G={list(){return k.get("hilt/projects/")},create(e){return k.post("hilt/projects/",e)},update(e){return k.put(`hilt/projects/${e.id}/`,e)},delete(e){return k.delete(`hilt/projects/${e}/`)},exportJSON(e){return k.get(`hilt/export/json/${e}/`)}};const W=N({id:"project",state:()=>({projectInfo:null}),getters:{getProjectInfo:e=>e.projectInfo,task:e=>e.projectInfo.task},actions:{setProject(e){this.projectInfo=e},exportJSON(){return G.exportJSON(this.projectInfo.id)}}}),ct={name:"CreateProjectModal",props:{dialogVisible:Boolean,existingInfo:Object},setup(){const e=W(),t=[];for(let s in E)t.push({id:s,name:E[s]});return{projectStore:e,taskOptions:t}},data(){return{projectInfo:{name:"",description:"",task:""},formRules:{name:[{required:!0,message:"Please input project name",trigger:"blur"}],description:[{required:!0,message:"Please input description",trigger:"blur"}],task:[{required:!0,message:"Please select task",trigger:"blur"}]}}},methods:{dialogIsOpen(){if(this.existingInfo)for(let e in this.existingInfo)this.projectInfo[e]=this.existingInfo[e];else this.projectInfo={name:"",description:"",task:""}},createProject(){this.$refs.projectInfoForm.validate(e=>{if(e){let t;this.existingInfo?t=G.update(this.projectInfo):t=G.create(this.projectInfo),t.then(s=>{this.projectStore.setProject(s),this.$emit("update:dialogVisible",!1),this.$router.push({name:"DocumentUpload"})})}})}}},it={class:"dialog-footer"},at=p("Cancel"),dt=p("Confirm");function ut(e,t,s,l,c,i){const a=r("el-input"),d=r("el-form-item"),h=r("el-option"),m=r("el-select"),f=r("el-form"),S=r("el-button"),w=r("el-dialog");return u(),b(w,{title:this.existingInfo?"Edit Existing Project":"Create New Project",modelValue:s.dialogVisible,"onUpdate:modelValue":t[4]||(t[4]=y=>s.dialogVisible=y),"onUpdate:visible":t[5]||(t[5]=y=>e.$emit("update:dialogVisible",y)),onOpen:this.dialogIsOpen,width:"40%"},{footer:n(()=>[_("span",it,[o(S,{onClick:t[3]||(t[3]=()=>e.$emit("update:dialogVisible",!1))},{default:n(()=>[at]),_:1}),o(S,{type:"primary",onClick:i.createProject},{default:n(()=>[dt]),_:1},8,["onClick"])])]),default:n(()=>[o(f,{model:c.projectInfo,rules:c.formRules,ref:"projectInfoForm"},{default:n(()=>[o(d,{label:"Name",prop:"name"},{default:n(()=>[o(a,{modelValue:c.projectInfo.name,"onUpdate:modelValue":t[0]||(t[0]=y=>c.projectInfo.name=y)},null,8,["modelValue"])]),_:1}),o(d,{label:"Description",prop:"description"},{default:n(()=>[o(a,{modelValue:c.projectInfo.description,"onUpdate:modelValue":t[1]||(t[1]=y=>c.projectInfo.description=y)},null,8,["modelValue"])]),_:1}),o(d,{label:"Task",prop:"task"},{default:n(()=>[o(m,{remote:"",modelValue:c.projectInfo.task,"onUpdate:modelValue":t[2]||(t[2]=y=>c.projectInfo.task=y),placeholder:"Select",style:{width:"100%"}},{default:n(()=>[(u(!0),D(B,null,V(l.taskOptions,y=>(u(),b(h,{key:y.id,label:y.name,value:y.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue","onOpen"])}var _t=C(ct,[["render",ut]]);const pt={name:"ProjectsPage",components:{CreateProjectModal:_t,Edit:Se,Delete:oe},setup(){const e=U(),t=W(),s=[];for(let l in E)s.push({text:E[l],value:E[l]});return{userStore:e,projectStore:t,filters:s}},data(){return{projects:[],dialogVisible:!1,selectedProject:null}},created:function(){this.fetchProjects()},methods:{handleProjectSelected(e,t){this.$router.push({name:"DocumentList"}),this.projectStore.setProject(t)},handleEdit(e,t){this.selectedProject=t,this.dialogVisible=!0},handleDelete(e,t){G.list(t.id).then(()=>{this.fetchProjects()})},fetchProjects(){G.list().then(e=>{this.projects=e.results},e=>{console.log(e)})},dateFormat(e,t){let s=e[t.property];return s?Be.fromISO(s).toISODate():""},convertTaskIDToString(e,t){let s=e[t.property];return s?E[s]:""},filterTask(e,t,s){let l=t[s.property],c=E[l];return e===c}}},mt={style:{"text-align":"center"}},ht=p("CREATE PROJECT "),ft=p(" Edit "),gt=p("Delete");function yt(e,t,s,l,c,i){const a=r("el-button"),d=r("el-col"),h=r("el-row"),m=r("el-link"),f=r("el-table-column"),S=r("Edit"),w=r("el-icon"),y=r("Delete"),x=r("el-popconfirm"),j=r("el-table"),v=r("CreateProjectModal");return u(),D("div",null,[_("div",mt,[_("h1",null,"Hello, "+I(this.userStore.username),1),o(h,null,{default:n(()=>[o(d,{span:12,offset:6},{default:n(()=>[o(a,{type:"primary",onClick:t[0]||(t[0]=()=>{this.selectedProject=null,this.dialogVisible=!0})},{default:n(()=>[ht]),_:1})]),_:1})]),_:1})]),o(h,null,{default:n(()=>[o(d,{span:12,offset:6},{default:n(()=>[o(j,{data:c.projects,stripe:"","default-sort":{prop:"updated_at",order:"descending"}},{default:n(()=>[o(f,{prop:"name",label:"Name",sortable:""},{default:n(g=>[o(m,{type:"primary",onClick:P=>i.handleProjectSelected(g.$index,g.row)},{default:n(()=>[p(I(g.row.name),1)]),_:2},1032,["onClick"])]),_:1}),o(f,{prop:"description",label:"Description",sortable:""}),o(f,{prop:"task",label:"Task",formatter:i.convertTaskIDToString,sortable:"",filters:this.filters,"filter-method":i.filterTask},null,8,["formatter","filters","filter-method"]),o(f,{prop:"updated_at",label:"Last Updated",formatter:i.dateFormat,sortable:""},null,8,["formatter"]),o(f,{label:"Operations"},{default:n(g=>[o(a,{size:"small",onClick:P=>i.handleEdit(g.$index,g.row)},{default:n(()=>[o(w,null,{default:n(()=>[o(S)]),_:1}),ft]),_:2},1032,["onClick"]),o(x,{title:"Are you sure?",onConfirm:P=>i.handleDelete(g.$index,g.row),style:{"margin-left":"10px"}},{reference:n(()=>[o(a,{size:"small",type:"danger"},{default:n(()=>[o(w,null,{default:n(()=>[o(y)]),_:1}),gt]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1}),o(v,{"dialog-visible":c.dialogVisible,"onUpdate:dialog-visible":t[1]||(t[1]=g=>c.dialogVisible=g),"existing-info":this.selectedProject},null,8,["dialog-visible","existing-info"])])}var St=C(pt,[["render",yt]]);const bt={name:"SetupSideBar",components:{Files:Te,UploadFilled:be,MessageBox:Ae,StarFilled:Ve,Edit:Se,Download:xe,DataAnalysis:Oe}},X=e=>(H("data-v-47dda05c"),e=e(),K(),e),xt=X(()=>_("span",null,"Corpus",-1)),Dt=p(" Overview "),wt=p(" Upload New Document "),vt=X(()=>_("span",null,"Labels",-1)),kt=X(()=>_("span",null,"Generate Explanations",-1)),$t=X(()=>_("span",null,"Export Data",-1)),It=X(()=>_("span",null,"Continue debugging",-1));function Ct(e,t,s,l,c,i){const a=r("MessageBox"),d=r("el-icon"),h=r("Files"),m=r("el-menu-item"),f=r("UploadFilled"),S=r("el-menu-item-group"),w=r("el-sub-menu"),y=r("StarFilled"),x=r("DataAnalysis"),j=r("Download"),v=r("el-menu"),g=r("Edit"),P=r("el-col");return u(),b(P,null,{default:n(()=>[o(v,{"default-active":e.$route.path,router:!0},{default:n(()=>[o(w,{index:"1"},{title:n(()=>[o(d,null,{default:n(()=>[o(a)]),_:1}),xt]),default:n(()=>[o(S,null,{default:n(()=>[o(m,{index:"/project/doc/list"},{default:n(()=>[o(d,null,{default:n(()=>[o(h)]),_:1}),Dt]),_:1}),o(m,{index:"/project/doc/upload"},{default:n(()=>[o(d,null,{default:n(()=>[o(f)]),_:1}),wt]),_:1})]),_:1})]),_:1}),o(m,{index:"/project/labels"},{default:n(()=>[o(d,null,{default:n(()=>[o(y)]),_:1}),vt]),_:1}),o(m,{index:"/project/generate-explanations"},{default:n(()=>[o(d,null,{default:n(()=>[o(x)]),_:1}),kt]),_:1}),o(m,{index:"/project/export"},{default:n(()=>[o(d,null,{default:n(()=>[o(j)]),_:1}),$t]),_:1})]),_:1},8,["default-active"]),o(v,null,{default:n(()=>[o(m,{onClick:t[0]||(t[0]=()=>this.$router.push({name:"DebugOverview"}))},{default:n(()=>[o(d,null,{default:n(()=>[o(g)]),_:1}),It]),_:1})]),_:1})]),_:1})}var jt=C(bt,[["render",Ct],["__scopeId","data-v-47dda05c"]]);const Ft={name:"ProjectSetupPage",components:{SetupSideBar:jt}};function Pt(e,t,s,l,c,i){const a=r("SetupSideBar"),d=r("el-aside"),h=r("router-view"),m=r("el-main"),f=r("el-container");return u(),D("div",null,[o(f,null,{default:n(()=>[o(d,{style:{"border-right":"solid 1px #e6e6e6"}},{default:n(()=>[o(a,{style:{width:"100%"}})]),_:1}),o(m,null,{default:n(()=>[o(h)]),_:1})]),_:1})])}var Lt=C(Ft,[["render",Pt]]);const Wt={name:"SetupDocument"};function Bt(e,t,s,l,c,i){const a=r("router-view");return u(),b(a)}var Tt=C(Wt,[["render",Bt]]),q={list(e,t,s){const l={};return t&&(l.page=t),s&&(l.page_size=s),k.get(`hilt/projects/${e}/docs/`,{params:l})},uploadFile(e,t,s){const l=new FormData;return l.append("dataset",t),l.append("format",s.toLowerCase()),k.post(`hilt/projects/${e}/docs/upload/`,l,{headers:le(z({},k.defaults.headers),{"Content-Type":"multipart/form-data"})})},markAnnotated(e,t){return k.put(`hilt/projects/${e}/docs/${t}/`,{annotated:!0})},delete(e,t){return k.delete(`hilt/projects/${e}/docs/${t}/`)},detailedDocument(e,t){return k.get(`hilt/projects/${e}/docs/${t}/words-annotations/`)}};const de=N({id:"document",state:()=>({documents:[],curPage:1,maxPage:1,totalDocCount:0,curDocIndex:0,annotatedDocCount:0,pageSize:10}),getters:{getDocuments:e=>e.documents,getdocumentInfo:e=>e},actions:{resetState(){return this.curPage=1,this.pageSize=10,this.fetchDocuments()},setCurDocIndex(e){this.curDocIndex=e},fetchDocuments(){const e=W();return q.list(e.getProjectInfo.id,this.curPage,this.pageSize).then(t=>(this.documents=t.results.results,this.totalDocCount=t.count,this.annotatedDocCount=t.results.annotatedCount,this.maxPage=Math.ceil(this.totalDocCount/this.pageSize),t))},updateCurPage(e){return this.curPage=e,this.curDocIndex=0,this.fetchDocuments()},deleteDocument(e){const t=W();return q.delete(t.getProjectInfo.id,e.id)},markAnnotated(){return this.documents[this.curDocIndex].id?q.markAnnotated(this.documents[this.curDocIndex].id).then(()=>{this.document[this.curDocIndex].annotated=!0}):null}}}),At={name:"DocumentList",components:{Search:ie,Delete:oe},setup(){return{documentStore:de()}},data(){return{searchQuery:""}},methods:{pageChanged(e){this.documentStore.updateCurPage(e)},indexMethod(e){return e+1},percentageText(e){return`${e} % annotated`},handleDelete(e,t){this.documentStore.deleteDocument(t).then(()=>{this.documentStore.fetchDocuments()})}},created(){this.documentStore.resetState()},computed:{percentageCompleted(){const e=this.documentStore.getdocumentInfo;if(!e)return 0;const t=e.annotatedDocCount,s=e.totalDocCount,l=t/s*100;return l||0}}},Vt={style:{"text-align":"center"}},Ot=_("h1",null,"All Uploaded Documents",-1),Et={style:{"align-content":"center"}},Nt=p("Delete");function zt(e,t,s,l,c,i){const a=r("el-progress"),d=r("Search"),h=r("el-icon"),m=r("el-input"),f=r("el-table-column"),S=r("Delete"),w=r("el-button"),y=r("el-popconfirm"),x=r("el-table"),j=r("el-pagination"),v=ne("snip");return u(),D("div",null,[_("div",Vt,[_("div",null,[Ot,o(a,{type:"circle",percentage:i.percentageCompleted,format:i.percentageText},null,8,["percentage","format"])]),o(m,{modelValue:c.searchQuery,"onUpdate:modelValue":t[0]||(t[0]=g=>c.searchQuery=g),placeholder:"Type to search for documents",style:{width:"50%"},clearable:""},{prefix:n(()=>[_("div",Et,[o(h,null,{default:n(()=>[o(d)]),_:1})])]),_:1},8,["modelValue"])]),o(x,{data:l.documentStore.getDocuments.filter(g=>!c.searchQuery||g.text.toLowerCase().includes(c.searchQuery.toLowerCase().trim())),stripe:""},{default:n(()=>[o(f,{type:"index",index:i.indexMethod},null,8,["index"]),o(f,{label:"Text"},{default:n(g=>[re((u(),D("p",null,[p(I(g.row.text),1)])),[[v,{lines:3}]])]),_:1}),o(f,{label:"Operations"},{default:n(g=>[o(y,{title:"Are you sure?",onConfirm:P=>i.handleDelete(g.$index,g.row),style:{"margin-left":"10px"}},{reference:n(()=>[o(w,{size:"small",type:"danger"},{default:n(()=>[o(h,null,{default:n(()=>[o(S)]),_:1}),Nt]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"]),o(j,{background:"",layout:"prev, pager, next",total:l.documentStore.getdocumentInfo.totalDocCount,"page-size":l.documentStore.getdocumentInfo.pageSize,"current-page":l.documentStore.getdocumentInfo.curPage,onCurrentChange:i.pageChanged,style:{"text-align":"center"}},null,8,["total","page-size","current-page","onCurrentChange"])])}var Ut=C(At,[["render",zt]]);const Mt={name:"DocumentUpload",components:{UploadFilled:be},setup(){return{projectStore:W()}},data(){return{fileForm:{fileType:"JSON"}}},methods:{uploadFile(e){q.uploadFile(this.projectStore.getProjectInfo.id,e.file,this.fileForm.fileType).then(()=>{this.$router.push({name:"Labels"})}).catch(t=>{console.log(t)})}}},T=e=>(H("data-v-94cda20c"),e=e(),K(),e),Rt=T(()=>_("h3",null,"Import your corpus below",-1)),Qt=T(()=>_("div",null,[p(" In order to start the annotation process, a corpus "),_("u",null,"must"),p(" be uploaded ")],-1)),qt=T(()=>_("div",null,"We accept datasets in the following formats:",-1)),Gt=T(()=>_("b",null,"JSON (recommended)",-1)),Jt=T(()=>_("br",null,null,-1)),Ht=T(()=>_("u",null,"Format:",-1)),Kt={style:{width:"fit-content","padding-left":"20px","padding-right":"20px",height:"fit-content"}},Xt=p("                "),Yt=p(`
{
  "data" : [
    {
      "text" : "Louis Armstrong the great trumpet player lived in Corona.",
      "words": ["Louis", "Armstrong", "the", "great", "trumpet", "player", "lived", "in", "Corona."],
      "annotations": [
        {
    `),Zt=p(`
          "label": "Label-Name-1"
    `),eo=p(`
          "label": "Label-Name-1",
          "start_offset": 0,
          "end_offset": 5,
    `),to=p(`
        }
      ]
    },
    ...
  ]
}
              `),oo=p(`
							`),no=p(" Each entry within "),ro=T(()=>_("i",null,"data",-1)),lo=p(" must have keys "),so=T(()=>_("i",null,[_("b",null,"text")],-1)),co=p(" and "),io=T(()=>_("i",null,[_("b",null,"words")],-1)),ao=p(". All other keys will be saved in a metadata dictionary associated with the text "),uo=T(()=>_("br",null,null,-1)),_o=p(" The "),po=T(()=>_("i",null,[_("b",null,"annotations")],-1)),mo=p(" key in each entry is optional. And, can be used to populate the document with label. "),ho=p("JSON file"),fo=T(()=>_("div",{class:"el-upload__text"},[p(" Drop file here or "),_("em",null,"click to upload")],-1));function go(e,t,s,l,c,i){const a=r("el-radio"),d=r("el-form-item"),h=r("UploadFilled"),m=r("el-icon"),f=r("el-upload"),S=r("el-form"),w=r("el-card"),y=r("el-col"),x=r("el-row");return u(),b(x,null,{default:n(()=>[o(y,null,{default:n(()=>[o(w,null,{header:n(()=>[Rt]),default:n(()=>[_("div",null,[Qt,qt,_("ul",null,[_("li",null,[Gt,Jt,Ht,_("pre",Kt,[Xt,_("code",null,[Yt,this.projectStore.task===1?(u(),D(B,{key:0},[Zt],64)):L("",!0),this.projectStore.task===2?(u(),D(B,{key:1},[eo],64)):L("",!0),to]),oo]),no,ro,lo,so,co,io,ao,uo,_o,po,mo])])]),o(S,{model:this.fileForm,style:{"text-align":"center"}},{default:n(()=>[o(d,null,{default:n(()=>[o(a,{modelValue:c.fileForm.fileType,"onUpdate:modelValue":t[0]||(t[0]=j=>c.fileForm.fileType=j),label:"JSON",border:""},{default:n(()=>[ho]),_:1},8,["modelValue"])]),_:1}),o(d,{label:""},{default:n(()=>[o(f,{"http-request":i.uploadFile,drag:"",accept:"text/json",ref:"uploadInput",action:""},{default:n(()=>[o(m,{size:48},{default:n(()=>[o(h)]),_:1}),fo]),_:1},8,["http-request"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})]),_:1})}var yo=C(Mt,[["render",go],["__scopeId","data-v-94cda20c"]]),he={list(e){return k.get(`hilt/projects/${e}/labels/?page_size=100`)},update(e,t){return k.put(`hilt/projects/${e}/labels/${t.id}/`,t)}};const Y=N({id:"label",state:()=>({labels:[],labelsMap:{}}),getters:{getLabels:e=>e.labels,getLabelByID:e=>t=>!t||!(t in e.labelsMap)?null:e.labels[e.labelsMap[t]]},actions:{fetchLabels(){const e=W();return he.list(e.getProjectInfo.id).then(t=>{const s={};for(let l=0;l<t.results.length;l++){const c=t.results[l];s[c.id]=l}return this.labels=t.results,this.labelsMap=s,t.results})},updateLabel(e){const t=W();return he.update(t.getProjectInfo.id,e)}}}),So={name:"LabelModificationPage",components:{QuestionFilled:Ee},setup(){const e=Y(),t=[];for(let s in M)t.push({id:s,name:M[s].name});return{labelStore:e,colorSetOptions:t}},data(){return{existingLabels:[],colors_sets:[],saving:!1}},methods:{goNextStep(){this.saving=!0;const e=[];for(let t=0;t<this.existingLabels.length;t++){const s=this.existingLabels[t],l=parseInt(this.colors_sets[t]);s.color_set!=l&&(s.color_set=l,e.push(this.labelStore.updateLabel(s)))}Promise.all(e).then(()=>{this.saving=!1,this.labelStore.fetchLabels(),this.$router.push({name:"GenerateExplanations"})})},getColors(e){return e=parseInt(e),e in M?M[e].colors:[]}},created(){this.labelStore.fetchLabels().then(e=>{const t={};for(let s in e)t[s]=""+e[s].color_set;this.colors_sets=t,this.existingLabels=e})},computed:{disableButton(){if(this.saving)return!0;const e={};for(let t in this.colors_sets){if(t in e)return!0;e[t]=null}return!1}}},bo=_("h3",null,"Label Space Creation",-1),xo={style:{"text-align":"left"}},Do=_("b",null,"Current Label Space",-1),wo={style:{"margin-left":"5px"}},vo=p(" Done ");function ko(e,t,s,l,c,i){const a=r("QuestionFilled"),d=r("el-icon"),h=r("el-popover"),m=r("el-col"),f=r("el-row"),S=r("el-divider"),w=r("el-option"),y=r("el-select"),x=r("el-form-item"),j=r("el-button"),v=r("el-form"),g=r("el-card");return u(),b(f,{style:{width:"100%"}},{default:n(()=>[o(g,{style:{width:"100%"}},{header:n(()=>[bo]),default:n(()=>[_("div",xo,[o(f,null,{default:n(()=>[o(m,{span:8},{default:n(()=>[o(h,{content:"Available labels for model to predict.",trigger:"hover"},{reference:n(()=>[_("span",null,[Do,o(d,{style:{"margin-left":"5px"}},{default:n(()=>[o(a)]),_:1})])]),_:1})]),_:1})]),_:1}),o(S),o(v,{model:c.colors_sets},{default:n(()=>[(u(!0),D(B,null,V(this.existingLabels,(P,F)=>(u(),b(f,{key:P.id},{default:n(()=>[o(x,{label:P.text},{default:n(()=>[o(y,{modelValue:this.colors_sets[F],"onUpdate:modelValue":A=>this.colors_sets[F]=A,placeholder:"Select",style:{width:"100%"}},{default:n(()=>[(u(!0),D(B,null,V(this.colorSetOptions,A=>(u(),b(w,{key:A.id,label:A.name,value:A.id},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"]),_("div",wo,[(u(!0),D(B,null,V(this.getColors(this.colors_sets[F]),(A,ee)=>(u(),D("span",{key:ee,style:R([A,{"margin-left":"5px",padding:"5px"}])}," Word ",4))),128))])]),_:2},1024))),128)),o(f,null,{default:n(()=>[o(j,{type:"success",disabled:this.disableButton,onClick:i.goNextStep},{default:n(()=>[vo]),_:1},8,["disabled","onClick"])]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1})}var $o=C(So,[["render",ko]]);const Io={name:"GenerateExplanations"};function Co(e,t,s,l,c,i){return"Generate Explanations Page"}var jo=C(Io,[["render",Co]]);const Fo={name:"ExportData",components:{Download:xe},setup(){return{projectStore:W()}},methods:{exportJSON(){this.projectStore.exportJSON().then(e=>{Ne(JSON.stringify(e,null,1),`${this.projectStore.getProjectInfo.name}.json`)})}}},Po=p(" Download JSON data ");function Lo(e,t,s,l,c,i){const a=r("Download"),d=r("el-icon"),h=r("el-button");return u(),b(h,{type:"primary",onClick:t[0]||(t[0]=m=>i.exportJSON())},{default:n(()=>[o(d,null,{default:n(()=>[o(a)]),_:1}),Po]),_:1})}var Wo=C(Fo,[["render",Lo]]);const Bo={name:"SetupSideBar",components:{Back:ae,Document:ze,DocumentCopy:Ue,List:Me,Management:Re}},Z=e=>(H("data-v-0288e801"),e=e(),K(),e),To=Z(()=>_("span",null,"Back",-1)),Ao=Z(()=>_("span",null,"Overview",-1)),Vo=Z(()=>_("span",null,"Dictionary",-1)),Oo=Z(()=>_("span",null,"Instance Explanations",-1)),Eo=Z(()=>_("span",null,"Task Explanations",-1));function No(e,t,s,l,c,i){const a=r("Back"),d=r("el-icon"),h=r("el-menu-item"),m=r("Management"),f=r("List"),S=r("Document"),w=r("DocumentCopy"),y=r("el-menu"),x=r("el-col");return u(),b(x,null,{default:n(()=>[o(y,{"default-active":e.$route.path},{default:n(()=>[o(h,{index:"1",onClick:t[0]||(t[0]=()=>this.$router.push({name:"DocumentList"}))},{default:n(()=>[o(d,null,{default:n(()=>[o(a)]),_:1}),To]),_:1}),o(h,{index:"/debug/overview",onClick:t[1]||(t[1]=()=>this.$router.push({name:"DebugOverview"}))},{default:n(()=>[o(d,null,{default:n(()=>[o(m)]),_:1}),Ao]),_:1}),o(h,{index:"/debug/dictionary",onClick:t[2]||(t[2]=()=>this.$router.push({name:"DebugDictionary"}))},{default:n(()=>[o(d,null,{default:n(()=>[o(f)]),_:1}),Vo]),_:1}),o(h,{index:"2",onClick:t[3]||(t[3]=()=>this.$router.push({name:"DebugLocal"}))},{default:n(()=>[o(d,null,{default:n(()=>[o(S)]),_:1}),Oo]),_:1}),o(h,{index:"3",onClick:t[4]||(t[4]=()=>this.$router.push({name:"DebugGlobal"}))},{default:n(()=>[o(d,null,{default:n(()=>[o(w)]),_:1}),Eo]),_:1})]),_:1},8,["default-active"])]),_:1})}var zo=C(Bo,[["render",No],["__scopeId","data-v-0288e801"]]);const ke=N({id:"detailedDocument",state:()=>({document:null,maxWords:50}),getters:{getDocument:e=>e.document,getMaxWords:e=>e.maxWords},actions:{fetchDocument(e){const t=W();return q.detailedDocument(t.getProjectInfo.id,e).then(s=>{const l={};for(let c of s.words){const i={};for(let a of c.word_annotation_score)i[a.annotation]=a,a.annotation in l||(l[a.annotation]=[]),l[a.annotation].push([a.score,a]);c.scores=i,delete c.word_annotation_score}for(let c in l){const i=l[c];i.sort((d,h)=>h[0]-d[0]);let a=0;for(let d=0;d<i.length;d++){const h=i[d];d>0&&i[d-1][0]!==h[0]&&(a=d),h[1].order=a}}this.document=s})}}});var se={list(e,t){const s=t!==void 0?`&doc_id=${t}`:"";return k.get(`hilt/projects/${e}/dict/local/?page_size=10000`+s)},create(e,t){return k.post(`hilt/projects/${e}/dict/local/`,t)},delete(e,t){return k.delete(`hilt/projects/${e}/dict/local/${t}/`)}};const $e=N({id:"dictionary_local",state:()=>({documents:{}}),getters:{getByDocumentID:e=>t=>e.documents[t],fetchIfExists:e=>(t,s,l)=>{if(!(t in e.documents))return null;const c=e.documents[t];if(!(s in c))return null;const i=c[s];return l in i?i[l]:null}},actions:{fetchDictionary(e){const t=W();return se.list(t.getProjectInfo.id,e).then(s=>{const l=s.results,c={};for(let i of l){const a=i.word.document;a in c||(c[a]={});const d=i.word.id;d in c[a]||(c[a][d]={});const h=i.annotation;c[a][d][h]=i}this.documents=c})},addWord(e,t){const s=W();return se.create(s.getProjectInfo.id,t).then(()=>{this.fetchDictionary(e)})},deleteWord(e){const t=W();return se.delete(t.getProjectInfo.id,e).then(()=>this.fetchDictionary())}}});const Uo={name:"LocalSideBar",components:{Back:ae,Check:De},setup(){const e=de(),t=ke(),s=Y(),l=$e();return{documentStore:e,detailedDocumentStore:t,labelStore:s,localDictionaryStore:l}},created(){const e=[];e.push(this.labelStore.fetchLabels()),e.push(this.documentStore.resetState().then(()=>this.localDictionaryStore.fetchDictionary(this.documentStore.getDocuments[this.documentStore.getdocumentInfo.curDocIndex].id))),Promise.all(e).then(()=>{this.detailedDocumentStore.fetchDocument(this.documentStore.getDocuments[this.documentStore.getdocumentInfo.curDocIndex].id)})},methods:{pageChanged(e){this.documentStore.updateCurPage(e).then(()=>{this.detailedDocumentStore.fetchDocument(this.documentStore.getDocuments[this.documentStore.getdocumentInfo.curDocIndex].id)})},goToDocument(e,t){this.documentStore.setCurDocIndex(e),this.detailedDocumentStore.fetchDocument(t.id),this.localDictionaryStore.fetchDictionary(t.id)}}},Mo=e=>(H("data-v-18621a56"),e=e(),K(),e),Ro=Mo(()=>_("span",null,"Back",-1)),Qo={key:0},qo={key:1};function Go(e,t,s,l,c,i){const a=r("Back"),d=r("el-icon"),h=r("el-menu-item"),m=r("el-menu"),f=r("Check"),S=r("el-table-column"),w=r("el-link"),y=r("el-table"),x=r("el-pagination"),j=r("el-col"),v=ne("snip");return u(),b(j,null,{default:n(()=>[o(m,null,{default:n(()=>[o(h,{onClick:t[0]||(t[0]=()=>this.$router.push({name:"DebugOverview"}))},{default:n(()=>[o(d,null,{default:n(()=>[o(a)]),_:1}),Ro]),_:1})]),_:1}),o(y,{data:l.documentStore.getDocuments},{default:n(()=>[o(S,{width:"40"},{default:n(g=>[g.row.annotated?(u(),D("span",Qo,[o(d,null,{default:n(()=>[o(f)]),_:1})])):(u(),D("div",qo,I(g.$index+1),1))]),_:1}),o(S,{prop:"text"},{default:n(g=>[re((u(),b(w,{onClick:P=>i.goToDocument(g.$index,g.row)},{default:n(()=>[p(I(g.row.text),1)]),_:2},1032,["onClick"])),[[v,{lines:3}]])]),_:1})]),_:1},8,["data"]),o(x,{background:"",layout:"prev, pager, next",total:l.documentStore.getdocumentInfo.totalDocCount,"page-size":l.documentStore.getdocumentInfo.pageSize,"current-page":l.documentStore.getdocumentInfo.curPage,onCurrentChange:i.pageChanged,style:{"text-align":"center"}},null,8,["total","page-size","current-page","onCurrentChange"])]),_:1})}var Jo=C(Uo,[["render",Go],["__scopeId","data-v-18621a56"]]),fe={list(e,t,s,l){const c={};return t&&(c.page=t),s!=null&&(c.page_size=s),l!=null&&(c.q=l),k.get(`hilt/projects/${e}/words/`,{params:c})},documents(e,t){return k.get(`hilt/projects/${e}/words/${t}/`)}};const Ie=N({id:"words",state:()=>({words:[],curPage:1,maxPage:1,totalWordCount:0,curWordIndex:0,pageSize:10,currDocuments:[],searchQuery:void 0,wordLoaded:!1}),getters:{getWords:e=>e.words,getWordInfo:e=>e,getCurrWord:e=>()=>e.words[e.curWordIndex]?e.words[e.curWordIndex].text:void 0,getDocuments:e=>e.currDocuments},actions:{resetState(e=void 0){return this.curPage=1,this.pageSize=10,this.currDocuments=[],this.searchQuery=e,this.fetchWords()},setCurWordIndex(e){this.curWordIndex=e},fetchWords(){const e=W();return fe.list(e.getProjectInfo.id,this.curPage,this.pageSize,this.searchQuery).then(t=>(this.words=t.results,this.totalWordCount=t.count,this.maxPage=Math.ceil(this.totalWordCount/this.pageSize),t))},updateCurPage(e){return this.curPage=e,this.curWordIndex=0,this.currDocuments=[],this.fetchWords()},fetchDocuments(){this.wordLoaded=!1;const e=W();return fe.documents(e.getProjectInfo.id,this.getCurrWord()).then(t=>{for(const s of t.results)for(let l of s.words){const c={};for(let i of l.word_annotation_score)c[i.annotation]=i;l.scores=c,delete l.word_annotation_score}this.currDocuments=t.results,this.wordLoaded=!0})}}});var ce={list(e,t){const s=t!==void 0?`&q=${t}`:"";return k.get(`hilt/projects/${e}/dict/global/?page_size=10000`+s)},create(e,t){return k.post(`hilt/projects/${e}/dict/global/`,t)},update(e,t){return k.put(`hilt/projects/${e}/dict/global/${t.id}/`,t)},delete(e,t){return k.delete(`hilt/projects/${e}/dict/global/${t}/`)}};const ue=N({id:"dictionary_global",state:()=>({words:{},wordRows:[]}),getters:{getWords:e=>e.words,getRows:e=>e.wordRows,containsWord:e=>t=>t in e.words},actions:{fetchDictionary(e=void 0){const t=W();return ce.list(t.getProjectInfo.id,e).then(s=>{const l=s.results,c={},i=[];for(let a of l)c[a.word]=i.length,i.push(a);this.words=c,this.wordRows=i})},addWord(e,t,s){const l=W();return ce.create(l.getProjectInfo.id,{word:e,modification_type:t,ground_truth_label:s}).then(c=>{this.words[e]=this.wordRows.length,this.wordRows.push(c)})},deleteWord(e){const t=W();return ce.delete(t.getProjectInfo.id,this.wordRows[this.words[e]].id).then(()=>this.fetchDictionary())}}});const Ho={name:"GlobalSideBar",components:{Back:ae,Check:De,Search:ie},setup(){const e=Y(),t=Ie(),s=ue();return{labelStore:e,wordStore:t,globalDictionaryStore:s}},data(){return{searchQuery:""}},watch:{searchQuery:function(e,t){console.log(e),e===""?this.wordStore.resetState().then(()=>{this.wordStore.fetchDocuments()}):this.wordStore.resetState(e).then(()=>{this.wordStore.fetchDocuments()})}},created(){this.$route.query.q!==void 0&&(this.searchQuery=this.$route.query.q);const e=[];e.push(this.labelStore.fetchLabels()),e.push(this.globalDictionaryStore.fetchDictionary()),this.searchQuery===""?e.push(this.wordStore.resetState()):e.push(this.wordStore.resetState(this.searchQuery)),Promise.all(e).then(()=>{this.wordStore.fetchDocuments()})},methods:{tableRowStyle({row:e}){return this.globalDictionaryStore.containsWord(e.text)?this.globalDictionaryStore.getRows[this.globalDictionaryStore.getWords[e.text]].modification_type==0?{color:"white",backgroundColor:"#67C23A"}:{color:"white",backgroundColor:"#F56C6C"}:{}},pageChanged(e){this.wordStore.updateCurPage(e).then(()=>{this.wordStore.fetchDocuments()})},goToDocument(e){this.wordStore.setCurWordIndex(e),this.wordStore.fetchDocuments()}}},Ko=e=>(H("data-v-5cdc2f13"),e=e(),K(),e),Xo=Ko(()=>_("span",null,"Back",-1)),Yo={style:{"align-content":"center"}},Zo={key:0},en={key:1};function tn(e,t,s,l,c,i){const a=r("Back"),d=r("el-icon"),h=r("el-menu-item"),m=r("el-menu"),f=r("Search"),S=r("el-input"),w=r("Check"),y=r("el-table-column"),x=r("el-link"),j=r("el-table"),v=r("el-pagination"),g=r("el-col"),P=ne("snip");return u(),b(g,null,{default:n(()=>[o(m,null,{default:n(()=>[o(h,{onClick:t[0]||(t[0]=()=>this.$router.push({name:"DebugOverview"}))},{default:n(()=>[o(d,null,{default:n(()=>[o(a)]),_:1}),Xo]),_:1})]),_:1}),o(S,{modelValue:c.searchQuery,"onUpdate:modelValue":t[1]||(t[1]=F=>c.searchQuery=F),placeholder:"Type to search for words",style:{"margin-top":"20px",width:"90%"},clearable:""},{prefix:n(()=>[_("div",Yo,[o(d,null,{default:n(()=>[o(f)]),_:1})])]),_:1},8,["modelValue"]),o(j,{data:Array.from(l.wordStore.getWords),"row-style":i.tableRowStyle},{default:n(()=>[o(y,{width:"40"},{default:n(F=>[l.globalDictionaryStore.containsWord(F.row.text)?(u(),D("span",Zo,[o(d,null,{default:n(()=>[o(w)]),_:1})])):(u(),D("div",en,I(l.wordStore.getWordInfo.pageSize*(l.wordStore.getWordInfo.curPage-1)+F.$index+1),1))]),_:1}),o(y,{prop:"text"},{default:n(F=>[re((u(),b(x,{key:F.row.text,onClick:A=>i.goToDocument(F.$index)},{default:n(()=>[p(I(F.row.text),1)]),_:2},1032,["onClick"])),[[P,{lines:3}]])]),_:1})]),_:1},8,["data","row-style"]),o(v,{background:"",layout:"prev, pager, next",total:l.wordStore.getWordInfo.totalWordCount,"page-size":l.wordStore.getWordInfo.pageSize,"current-page":l.wordStore.getWordInfo.curPage,onCurrentChange:i.pageChanged,style:{"text-align":"center"}},null,8,["total","page-size","current-page","onCurrentChange"])]),_:1})}var on=C(Ho,[["render",tn],["__scopeId","data-v-5cdc2f13"]]);const nn={name:"DebugPage",components:{OverviewSideBar:zo,LocalSideBar:Jo,GlobalSideBar:on}};function rn(e,t,s,l,c,i){const a=r("OverviewSideBar"),d=r("LocalSideBar"),h=r("GlobalSideBar"),m=r("el-aside"),f=r("router-view"),S=r("el-main"),w=r("el-container");return u(),D("div",null,[o(w,null,{default:n(()=>[o(m,{style:{"border-right":"solid 1px #e6e6e6"}},{default:n(()=>[this.$route.path.endsWith("/overview")||this.$route.path.endsWith("/dictionary")?(u(),b(a,{key:0,style:{width:"100%"}})):L("",!0),this.$route.path.endsWith("/local")?(u(),b(d,{key:1,style:{width:"100%"}})):L("",!0),this.$route.path.endsWith("/global")?(u(),b(h,{key:2,style:{width:"100%"}})):L("",!0)]),_:1}),o(S,null,{default:n(()=>[o(f)]),_:1})]),_:1})])}var ln=C(nn,[["render",rn]]);const sn={name:"DebugOverview"};function cn(e,t,s,l,c,i){return"Debug Overview Page"}var an=C(sn,[["render",cn]]);const dn={name:"LocalExplanations",components:{ArrowLeft:we,ArrowRight:ve,Delete:oe},setup(){const e=de(),t=ke(),s=W(),l=$e(),c=Y();return{documentStore:e,detailedDocumentStore:t,projectStore:s,localDictionaryStore:l,labelStore:c,TaskTypes:E,getLabelByID:c.getLabelByID}},data(){return{topK:3}},methods:{wordDelete(e){this.localDictionaryStore.deleteWord(e)},wordClick(e,t,s){const l=this.detailedDocumentStore.getDocument.id,c=this.localDictionaryStore.fetchIfExists(l,t,e);c===null?s>=0&&this.localDictionaryStore.addWord(l,{word:t,annotation:e,modification_type:s}):s==-1&&this.wordDelete(c.id)},getColors(e){const t=this.getLabelByID(e);return M[t.color_set].colors},getWordStyle(e,t){const s={padding:"3px 3px 3px 3px",margin:"3px 3px 3px 3px",fontSize:"18px"};if(this.topK>0&&e.order>=this.topK)return s;const l=e.score,c=this.getColors(t);let i=-1;return l<=0?s:(l<=.33?i=0:l<=.66?i=1:l<=1&&(i=2),z(z({},s),c[i]))},getProgressBarLabel(){let e=this.documentStore.getdocumentInfo;return`${e.annotatedDocCount} / ${e.totalDocCount} documents annotated`},goToPrevDoc(){const e=this.documentStore.getdocumentInfo.curDocIndex-1;e==-1?this.documentStore.updateCurPage(this.documentStore.getdocumentInfo.curPage-1).then(()=>{this.documentStore.setCurDocIndex(this.documentStore.getDocuments.length-1),this.detailedDocumentStore.fetchDocument(this.documentStore.getDocuments[this.documentStore.getDocuments.length-1].id)}):(this.documentStore.setCurDocIndex(e),this.detailedDocumentStore.fetchDocument(this.documentStore.getDocuments[e].id))},goToNextDoc(){const e=this.documentStore.getdocumentInfo.curDocIndex+1;this.documentStore.getDocuments.length==e?this.documentStore.updateCurPage(this.documentStore.getdocumentInfo.curPage+1).then(()=>{this.detailedDocumentStore.fetchDocument(this.documentStore.getDocuments[0].id),this.localDictionaryStore.fetchDictionary(this.documentStore.getDocuments[0].id)}):(this.documentStore.setCurDocIndex(e),this.detailedDocumentStore.fetchDocument(this.documentStore.getDocuments[e].id),this.localDictionaryStore.fetchDictionary(this.documentStore.getDocuments[e].id))},noAnnotation(){this.documentStore.markAnnotated().then(()=>{const e=this.documentStore.getdocumentInfo.curDocIndex+1;this.documentStore.getDocuments.length!==e&&this.documentStore.getdocumentInfo.curPage!==this.documentStore.getdocumentInfo.maxPage&&this.goToNextDoc()})}},computed:{annotationCompletionPercentage:function(){let e=this.documentStore.getdocumentInfo;return e.totalDocCount==0?0:100*e.annotatedDocCount/e.totalDocCount},dictTableData:function(){const e=this.detailedDocumentStore.getDocument.id,t=this.localDictionaryStore.getByDocumentID(e),s=[];if(e===void 0||t===void 0)return s;const l=this.detailedDocumentStore.getDocument.words;for(const c of l){const i=c.id;if(!(i in t))continue;const a=t[i];for(const d in a){const h=a[d].id,m=c.scores[d].score;let f;for(const S of this.detailedDocumentStore.getDocument.annotations)if(S.id==d){f=S.label;break}s.push({id:h,word:c.text,score:{score:m,order:0},label:f,type:a[d].modification_type})}}return s}}},un={style:{display:"flex","align-items":"center","justify-content":"space-between"}},_n={style:{"text-align":"center"}},pn={style:{width:"100%"}},mn={key:0,class:"demonstration"},hn={key:1,class:"demonstration"},fn=p("Words"),gn=p("Model Output"),yn={style:{"text-align":"right",margin:"0"}},Sn=p(" add "),bn=p(" remove "),xn=p(" reset "),Dn=p("Add"),wn=p("Remove"),vn=p("Delete"),kn=p(" Prev "),$n=p(" Next "),In=p(" Skip (Nothing to Mark Up)");function Cn(e,t,s,l,c,i){const a=r("el-row"),d=r("el-progress"),h=r("el-slider"),m=r("el-tag"),f=r("el-divider"),S=r("el-button"),w=r("el-popover"),y=r("el-col"),x=r("el-table-column"),j=r("Delete"),v=r("el-icon"),g=r("el-popconfirm"),P=r("el-table"),F=r("el-card"),A=r("ArrowLeft"),ee=r("ArrowRight");return u(),b(a,{style:{width:"100%"}},{default:n(()=>[o(a,{style:{width:"100%"}},{default:n(()=>[_("div",un,[_("h1",_n," Annotate page ("+I(l.TaskTypes[this.projectStore.task])+") ",1)])]),_:1}),o(a,{style:{width:"100%"}},{default:n(()=>[o(d,{style:{width:"100%"},percentage:i.annotationCompletionPercentage,format:i.getProgressBarLabel,type:"line","stroke-width":30,"text-inside":""},null,8,["percentage","format"]),_("div",pn,[c.topK>0?(u(),D("span",mn,"Top "+I(c.topK)+" words",1)):L("",!0),c.topK==0?(u(),D("span",hn,"All words")):L("",!0),o(h,{modelValue:c.topK,"onUpdate:modelValue":t[0]||(t[0]=$=>c.topK=$),max:this.detailedDocumentStore.getMaxWords},null,8,["modelValue","max"])])]),_:1}),this.detailedDocumentStore.getDocument?(u(),b(F,{key:0,style:{width:"100%","margin-top":"10px"}},{default:n(()=>[o(a,null,{default:n(()=>[o(y,{span:16},{default:n(()=>[o(a,null,{default:n(()=>[o(m,null,{default:n(()=>[fn]),_:1}),"ground_truth"in this.detailedDocumentStore.getDocument?(u(),b(m,{key:0,style:{"margin-left":"10px"}},{default:n(()=>[p(" Ground truth: "+I(l.getLabelByID(this.detailedDocumentStore.getDocument.ground_truth).text),1)]),_:1})):L("",!0)]),_:1}),o(a,{style:{"line-height":"2","margin-top":"10px"}},{default:n(()=>[_("div",null,[(u(!0),D(B,null,V(this.detailedDocumentStore.getDocument.words,$=>(u(),D("span",{style:{padding:"3px","font-size":"18px"},key:$.id},I($.text),1))),128))])]),_:1}),o(f),(u(!0),D(B,null,V(this.detailedDocumentStore.getDocument.annotations,$=>(u(),b(a,{style:{"margin-top":"10px"},key:$.id},{default:n(()=>[o(a,{style:{width:"100%"}},{default:n(()=>[o(m,{style:{"margin-right":"10px"}},{default:n(()=>[gn]),_:1}),o(m,null,{default:n(()=>[p("Label: "+I(l.getLabelByID($.label).text),1)]),_:2},1024)]),_:2},1024),o(a,{style:{"line-height":"2","margin-top":"10px"}},{default:n(()=>[_("div",null,[(u(!0),D(B,null,V(this.detailedDocumentStore.getDocument.words,O=>(u(),D("span",{key:O.id,style:R(i.getWordStyle(O.scores[$.id],$.label))},[o(w,{trigger:"hover",width:"200px"},{reference:n(()=>[_("span",null,I(O.text),1)]),default:n(()=>[_("p",null,I(O.text+": "+O.scores[$.id].score),1),_("div",yn,[o(S,{size:"small",type:"success",onClick:_e=>i.wordClick($.id,O.id,0)},{default:n(()=>[Sn]),_:2},1032,["onClick"]),o(S,{size:"small",type:"primary",onClick:_e=>i.wordClick($.id,O.id,1)},{default:n(()=>[bn]),_:2},1032,["onClick"]),o(S,{size:"small",type:"info",onClick:_e=>i.wordClick($.id,O.id,-1)},{default:n(()=>[xn]),_:2},1032,["onClick"])])]),_:2},1024)],4))),128))])]),_:2},1024)]),_:2},1024))),128))]),_:1}),o(y,{span:8},{default:n(()=>[o(P,{data:i.dictTableData,border:"",style:{width:"100%"}},{default:n(()=>[o(x,{label:"Word"},{default:n($=>[_("span",{style:R(i.getWordStyle($.row.score,$.row.label))},I($.row.word),5)]),_:1}),o(x,{label:"Type"},{default:n($=>[$.row.type==0?(u(),b(m,{key:0,type:"success"},{default:n(()=>[Dn]),_:1})):L("",!0),$.row.type==1?(u(),b(m,{key:1,type:"danger"},{default:n(()=>[wn]),_:1})):L("",!0)]),_:1}),o(x,{label:"Operations"},{default:n($=>[o(g,{title:"Are you sure?",onConfirm:O=>i.wordDelete($.row.id),style:{"margin-left":"10px"}},{reference:n(()=>[o(S,{size:"small",type:"danger"},{default:n(()=>[o(v,null,{default:n(()=>[o(j)]),_:1}),vn]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1})]),_:1})):L("",!0),o(a,{style:{"margin-top":"20px",width:"100%"}},{default:n(()=>[o(y,{style:{display:"flex","justify-content":"space-between"}},{default:n(()=>[o(S,{type:"primary",onClick:t[1]||(t[1]=$=>i.goToPrevDoc()),disabled:this.documentStore.getdocumentInfo.curDocIndex===0&&this.documentStore.getdocumentInfo.curPage===1},{default:n(()=>[o(v,null,{default:n(()=>[o(A)]),_:1}),kn]),_:1},8,["disabled"]),o(S,{type:"primary",onClick:t[2]||(t[2]=$=>i.goToNextDoc()),disabled:this.documentStore.getdocumentInfo.curDocIndex===this.documentStore.getdocumentInfo.documents.length-1&&this.documentStore.getdocumentInfo.curPage===this.documentStore.getdocumentInfo.maxPage},{default:n(()=>[$n,o(v,null,{default:n(()=>[o(ee)]),_:1})]),_:1},8,["disabled"])]),_:1})]),_:1}),this.detailedDocumentStore.getDocument?(u(),b(a,{key:1,style:{"margin-top":"10px",width:"100%"}},{default:n(()=>[o(y,{style:{display:"flex","justify-content":"flex-end"}},{default:n(()=>[o(S,{type:"primary",onClick:i.noAnnotation},{default:n(()=>[In,o(v,null,{default:n(()=>[o(ee)]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1})):L("",!0)]),_:1})}var jn=C(dn,[["render",Cn]]);const Fn={name:"GlobalExplanations",components:{ArrowLeft:we,ArrowRight:ve},setup(){const e=Y(),t=Ie(),s=ue(),l=W();return{labelStore:e,wordStore:t,globalDictionaryStore:s,projectStore:l,TaskTypes:E,getLabelByID:e.getLabelByID}},computed:{documents:function(){return this.wordStore.getDocuments}},methods:{addWord(e){this.globalDictionaryStore.addWord(this.wordStore.getCurrWord(),e,this.getLabelByID(this.documents[0].ground_truth).id)},getColors(e){const t=this.getLabelByID(e);return M[t.color_set].colors},getWordStyle(e,t){const s={padding:"3px 3px 3px 3px",margin:"3px 3px 3px 3px",fontSize:"18px"},l=e.score,c=this.getColors(t);let i=-1;return l<=0?s:(l<=.33?i=0:l<=.66?i=1:l<=1&&(i=2),z(z({},s),c[i]))},goToPrevWord(){const e=this.wordStore.getWordInfo.curWordIndex-1;e==-1?this.wordStore.updateCurPage(this.wordStore.getWordInfo.curPage-1).then(()=>{this.wordStore.setCurWordIndex(this.wordStore.getWords.length-1),this.wordStore.fetchDocuments()}):(this.wordStore.setCurWordIndex(e),this.wordStore.fetchDocuments())},goToNextWord(){const e=this.wordStore.getWordInfo.curWordIndex+1;this.wordStore.getWords.length==e?this.wordStore.updateCurPage(this.wordStore.getWordInfo.curPage+1).then(()=>{this.wordStore.fetchDocuments()}):(this.wordStore.setCurWordIndex(e),this.wordStore.fetchDocuments())}}},Pn={style:{display:"flex","align-items":"center","justify-content":"space-between"}},Ln={style:{"text-align":"center"}},Wn=p(" Prev "),Bn=p(" Next "),Tn=p(" Current Word: "),An={style:{"margin-left":"10px",display:"inline-block"}},Vn=p(" add "),On=p(" remove "),En=p(" reset ");function Nn(e,t,s,l,c,i){const a=r("el-row"),d=r("ArrowLeft"),h=r("el-icon"),m=r("el-button"),f=r("ArrowRight"),S=r("el-col"),w=r("el-tag"),y=r("el-popover"),x=r("el-divider"),j=r("el-card");return u(),b(a,{style:{width:"100%"}},{default:n(()=>[o(a,{style:{width:"100%"}},{default:n(()=>[_("div",Pn,[_("h1",Ln," Annotate page ("+I(l.TaskTypes[this.projectStore.task])+") ",1)])]),_:1}),l.wordStore.getCurrWord()!==void 0?(u(),b(a,{key:0,style:{"margin-top":"20px",width:"100%"}},{default:n(()=>[o(S,{style:{display:"flex","justify-content":"space-between"}},{default:n(()=>[o(m,{type:"primary",onClick:t[0]||(t[0]=v=>i.goToPrevWord()),disabled:this.wordStore.getWordInfo.curWordIndex===0&&this.wordStore.getWordInfo.curPage===1},{default:n(()=>[o(h,null,{default:n(()=>[o(d)]),_:1}),Wn]),_:1},8,["disabled"]),o(m,{type:"primary",onClick:t[1]||(t[1]=v=>i.goToNextWord()),disabled:this.wordStore.getWordInfo.curWordIndex===this.wordStore.getWordInfo.words.length-1&&this.wordStore.getWordInfo.curPage===this.wordStore.getWordInfo.maxPage},{default:n(()=>[Bn,o(h,null,{default:n(()=>[o(f)]),_:1})]),_:1},8,["disabled"])]),_:1})]),_:1})):L("",!0),l.wordStore.wordLoaded?(u(),b(j,{key:1,style:{width:"100%","margin-top":"10px"}},{header:n(()=>[_("div",null,[Tn,_("b",null,I(this.wordStore.getCurrWord()),1),_("div",An,[l.globalDictionaryStore.containsWord(l.wordStore.getCurrWord())?L("",!0):(u(),b(m,{key:0,size:"small",type:"success",onClick:t[2]||(t[2]=v=>i.addWord(0))},{default:n(()=>[Vn]),_:1})),l.globalDictionaryStore.containsWord(l.wordStore.getCurrWord())?L("",!0):(u(),b(m,{key:1,size:"small",type:"primary",onClick:t[3]||(t[3]=v=>i.addWord(1))},{default:n(()=>[On]),_:1})),l.globalDictionaryStore.containsWord(l.wordStore.getCurrWord())?(u(),b(m,{key:2,size:"small",type:"info",onClick:t[4]||(t[4]=v=>l.globalDictionaryStore.deleteWord(l.wordStore.getCurrWord()))},{default:n(()=>[En]),_:1})):L("",!0)])])]),default:n(()=>[(u(!0),D(B,null,V(i.documents,(v,g)=>(u(),b(a,{style:{width:"100%"},key:v.id},{default:n(()=>[(u(!0),D(B,null,V(v.annotations,P=>(u(),b(a,{style:{width:"100%"},key:P.id},{default:n(()=>[o(a,{style:{width:"100%"}},{default:n(()=>[o(w,null,{default:n(()=>[p("Document #"+I(g+1),1)]),_:2},1024),"ground_truth"in v?(u(),b(w,{key:0,style:{"margin-left":"10px"}},{default:n(()=>[p(" Ground truth: "+I(l.getLabelByID(v.ground_truth).text),1)]),_:2},1024)):L("",!0),o(w,{style:{"margin-left":"10px"}},{default:n(()=>[p(" Prediction: "+I(l.getLabelByID(P.label).text),1)]),_:2},1024)]),_:2},1024),o(a,{style:{"line-height":"2","margin-top":"10px"}},{default:n(()=>[_("div",null,[(u(!0),D(B,null,V(v.words,F=>(u(),D("span",{key:F.id,style:R(i.getWordStyle(F.scores[P.id],P.label))},[o(y,{content:F.text+": "+F.scores[P.id].score,trigger:"hover"},{reference:n(()=>[_("span",{style:R(F.text===this.wordStore.getCurrWord()?{border:"2px solid black"}:{})},I(F.text),5)]),_:2},1032,["content"])],4))),128))])]),_:2},1024)]),_:2},1024))),128)),o(x)]),_:2},1024))),128))]),_:1})):L("",!0)]),_:1})}var zn=C(Fn,[["render",Nn]]);const Un={name:"DictionaryOverview",components:{Search:ie,Delete:oe},setup(){return{dictionaryStore:ue()}},data(){return{searchQuery:""}},watch:{searchQuery:function(e,t){this.dictionaryStore.fetchDictionary(e)}},methods:{indexMethod(e){return e+1},onClick(e,t){this.$router.push({name:"DebugGlobal",query:{q:t.word}})},handleDelete(e,t){this.dictionaryStore.deleteWord(t.word).then(()=>{this.dictionaryStore.fetchDictionary()})}},created(){this.dictionaryStore.fetchDictionary()}},Mn={style:{"text-align":"center"}},Rn=_("div",null,[_("h1",null,"Task Dictionary")],-1),Qn={style:{"align-content":"center"}},qn=["onClick"],Gn=p("Delete");function Jn(e,t,s,l,c,i){const a=r("Search"),d=r("el-icon"),h=r("el-input"),m=r("el-table-column"),f=r("Delete"),S=r("el-button"),w=r("el-popconfirm"),y=r("el-table");return u(),D("div",null,[_("div",Mn,[Rn,o(h,{modelValue:c.searchQuery,"onUpdate:modelValue":t[0]||(t[0]=x=>c.searchQuery=x),modelModifiers:{lazy:!0,trim:!0},placeholder:"Type to search for words",style:{width:"50%"},clearable:""},{prefix:n(()=>[_("div",Qn,[o(d,null,{default:n(()=>[o(a)]),_:1})])]),_:1},8,["modelValue"])]),o(y,{data:Array.from(l.dictionaryStore.getRows),stripe:""},{default:n(()=>[o(m,{type:"index",index:i.indexMethod},null,8,["index"]),o(m,{label:"Text",sortable:""},{default:n(x=>[_("p",{onClick:j=>i.onClick(x.$index,x.row),style:{cursor:"pointer"}},I(x.row.word),9,qn)]),_:1}),o(m,{label:"Operations"},{default:n(x=>[o(w,{title:"Are you sure?",onConfirm:j=>i.handleDelete(x.$index,x.row),style:{"margin-left":"10px"}},{reference:n(()=>[o(S,{size:"small",type:"danger"},{default:n(()=>[o(d,null,{default:n(()=>[o(f)]),_:1}),Gn]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])])}var Hn=C(Un,[["render",Jn]]),te={updateToken(e){k.defaults.headers.Authorization=`Bearer ${e}`},login(e,t,s=!1){const l=U();return k.post("token/",{username:e,password:t,rememberMe:s}).then(c=>(c.token=c.access,delete c.access,l.login(le(z({},c),{username:e})),c))},refreshToken(){const e=U();return k.post("token/refresh/",{token:e.token}).then(t=>{e.updateToken(t.token)})}};const Kn={name:"LoginPage",components:{UserFilled:Qe,Lock:qe},data(){return{loginForm:{username:"",password:"",rememberMe:!1},rules:{username:[{required:!0,message:"Please input username",trigger:"blur"}],password:[{required:!0,message:"Please input password",trigger:"blur"}]},isLoading:!1,isValid:!1,showLoginFailed:"none"}},methods:{login(){this.$refs.loginForm.validate(e=>{if(e)this.isLoading=!0,this.showLoginFailed="none",te.login(this.loginForm.username,this.loginForm.password,this.loginForm.rememberMe).catch(()=>{this.isLoading=!1,this.showLoginFailed=""});else return!1})}}},Xn={style:{display:"flex","justify-content":"center"}},Yn=p(" Login ");function Zn(e,t,s,l,c,i){const a=r("el-alert"),d=r("UserFilled"),h=r("el-icon"),m=r("el-input"),f=r("el-form-item"),S=r("Lock"),w=r("el-checkbox"),y=r("el-button"),x=r("el-form"),j=r("el-col"),v=ne("loading");return u(),D("div",Xn,[re((u(),b(j,{span:6},{default:n(()=>[o(a,{title:"Invalid username/password",type:"error","show-icon":"",style:R({display:c.showLoginFailed})},null,8,["style"]),o(x,{model:c.loginForm,rules:c.rules,ref:"loginForm"},{default:n(()=>[o(f,{label:"Username",prop:"username",class:"bold-label"},{default:n(()=>[o(m,{modelValue:c.loginForm.username,"onUpdate:modelValue":t[0]||(t[0]=g=>c.loginForm.username=g)},{prefix:n(()=>[o(h,null,{default:n(()=>[o(d)]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(f,{label:"Password",prop:"password",class:"bold-label"},{default:n(()=>[o(m,{type:"password",modelValue:c.loginForm.password,"onUpdate:modelValue":t[1]||(t[1]=g=>c.loginForm.password=g)},{prefix:n(()=>[o(h,null,{default:n(()=>[o(S)]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(f,null,{default:n(()=>[o(w,{label:"Remember me",modelValue:c.loginForm.rememberMe,"onUpdate:modelValue":t[2]||(t[2]=g=>c.loginForm.rememberMe=g)},null,8,["modelValue"])]),_:1}),o(f,null,{default:n(()=>[o(y,{type:"primary",onClick:i.login,disabled:this.isValid,style:{width:"100%"}},{default:n(()=>[Yn]),_:1},8,["onClick","disabled"])]),_:1})]),_:1},8,["model","rules"])]),_:1})),[[v,c.isLoading]])])}var er=C(Kn,[["render",Zn],["__scopeId","data-v-0194bcf7"]]);const tr={name:"LogoutPage",setup(){return{userStore:U()}},created(){this.userStore.logout()}};function or(e,t,s,l,c,i){return u(),D("div")}var nr=C(tr,[["render",or]]);const J=Ge({history:Je("/"),routes:[{path:"/",name:"Home",component:st},{path:"/projects",name:"Projects",component:St},{path:"/login",name:"Login",component:er},{path:"/logout",component:nr},{path:"/project/",component:Lt,children:[{path:"doc/",component:Tt,children:[{path:"upload",name:"DocumentUpload",component:yo},{path:"list",name:"DocumentList",component:Ut}]},{path:"labels",name:"Labels",component:$o},{path:"generate-explanations",name:"GenerateExplanations",component:jo},{path:"export",name:"ExportData",component:Wo}]},{path:"/debug/",component:ln,children:[{path:"overview",name:"DebugOverview",component:an},{path:"dictionary",name:"DebugDictionary",component:Hn},{path:"local",name:"DebugLocal",component:jn},{path:"global",name:"DebugGlobal",component:zn}]}]});J.beforeEach((e,t,s)=>{!U().isLoggedIn&&e.name!=="Login"&&e.name!=="Home"?s("/login"):s()});J.afterEach(()=>{const e=U();e.isLoggedIn&&e.inspectToken()});const U=N({id:"user",presist:!0,state:()=>({userInfo:null}),getters:{username:e=>e.userInfo.username,token:e=>e.userInfo.token,isLoggedIn:e=>e.userInfo!==null},actions:{login(e){this.userInfo=e,te.updateToken(e.token),J.push({name:"Projects"}).then(t=>t)},logout(){this.userInfo=null,J.push("/").then(e=>e)},updateToken(e){this.userInfo.token=e,te.updateToken(e)},inspectToken(){const e=this.userInfo.token;if(e){const t=He(e),s=t.exp,l=t.orig_iat;s<Date.now()/1e3?this.logout():s-Date.now()/1e3<1800&&Date.now()/1e3-l<628200&&te.refreshToken()}}}});var rr="/assets/logo.4941f0a9.png";const lr={name:"NavBar",components:{},setup(){return{userStore:U(),Logo:rr}},methods:{loginClicked(){this.userStore.isLoggedIn?this.$router.push("/login"):this.$router.push("/logout")}}},sr=p(" HILT "),cr=p(" Projects ");function ir(e,t,s,l,c,i){const a=r("el-image"),d=r("el-menu-item"),h=r("el-button"),m=r("el-menu");return u(),b(m,{"default-active":e.$route.path,mode:"horizontal",router:!0},{default:n(()=>[o(d,{index:"/"},{default:n(()=>[o(a,{src:l.Logo,style:{width:"58px",height:"58px"}},null,8,["src"])]),_:1}),o(d,{index:"1"},{default:n(()=>[sr]),_:1}),l.userStore.isLoggedIn?(u(),b(d,{key:0,index:"/projects"},{default:n(()=>[cr]),_:1})):L("",!0),o(d,{index:l.userStore.isLoggedIn?"/logout":"/login",class:"dock-right"},{default:n(()=>[o(h,{onClick:t[0]||(t[0]=f=>i.loginClicked(f)),jest:"logBtn"},{default:n(()=>[p(I(this.userStore.isLoggedIn?"Logout":"Login"),1)]),_:1})]),_:1},8,["index"])]),_:1},8,["default-active"])}var ar=C(lr,[["render",ir],["__scopeId","data-v-6c47ac32"]]);const dr={components:{NavBar:ar}},ur={id:"app"};function _r(e,t,s,l,c,i){const a=r("NavBar"),d=r("router-view");return u(),D("div",ur,[o(a,{style:{width:"100%"}}),o(d)])}var pr=C(dr,[["render",_r]]);const Q=Ke(pr);Q.use(Xe);Q.provide("$api",k);Q.use(Ye,{locale:Ze});const Ce=et();Ce.use(tt);Q.use(Ce);Q.use(J);Q.mount("#app");
