var Me=Object.defineProperty,Ae=Object.defineProperties;var Be=Object.getOwnPropertyDescriptors;var De=Object.getOwnPropertySymbols;var Ve=Object.prototype.hasOwnProperty,Ee=Object.prototype.propertyIsEnumerable;var we=(e,t,s)=>t in e?Me(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,V=(e,t)=>{for(var s in t||(t={}))Ve.call(t,s)&&we(e,s,t[s]);if(De)for(var s of De(t))Ee.call(t,s)&&we(e,s,t[s]);return e},Z=(e,t)=>Ae(e,Be(t));import{o as _,c as D,F as T,a as d,b as Ie,E as X,d as O,r,e as b,w as n,f as o,g as M,h as p,i as $e,_ as le,D as Ue,t as P,j as Oe,u as pe,m as ze,s as Ne,k as Ce,l as je,n as Fe,p as N,q as R,v as me,x as se,y as ie,z as j,A as Re,B as Ge,C as qe,G as Q,H as Qe,I as ae,J as Je,K as He,L as Ke,M as Ze,N as he,O as Pe,P as Le,Q as Xe,R as Ye,S as et,T as tt,U as ot,V as nt,W as rt,X as lt,Y as st,Z as it,$ as at}from"./vendor.5a3503cd.js";const ct=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function s(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerpolicy&&(a.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?a.credentials="include":l.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(l){if(l.ep)return;l.ep=!0;const a=s(l);fetch(l.href,a)}};ct();var C=(e,t)=>{const s=e.__vccOpts||e;for(const[i,l]of t)s[i]=l;return s};const dt={name:"HomePage",components:{}},ut=d("h1",{style:{"text-align":"center"}},"Home page of HILT Demo",-1),_t=d("div",{style:{display:"flex","justify-content":"center"}},[d("p",null," (Guideline will be uploaded soon) ")],-1);function pt(e,t,s,i,l,a){return _(),D(T,null,[ut,_t],64)}var mt=C(dt,[["render",pt]]);const U={1:"Sequence Classification",2:"Relation Extraction"},G={0:{name:"Neutral",colors:[{"background-color":"#FFFFFF",color:"#000000"},{"background-color":"#FFFFFF",color:"#000000"},{"background-color":"#FFFFFF",color:"#000000"},{"background-color":"#FFFFFF",color:"#000000"},{"background-color":"#FFFFFF",color:"#000000"}]},1:{name:"Red",colors:[{"background-color":"#EA9999",color:"#000000"},{"background-color":"#E06666",color:"#FFFFFF"},{"background-color":"#CC0000",color:"#FFFFFF"}]},2:{name:"Blue",colors:[{"background-color":"#ADD8E6",color:"#000000"},{"background-color":"#4682B4",color:"#000000"},{"background-color":"#00008B",color:"#FFFFFF"}]},3:{name:"Green",colors:[{"background-color":"#8AFF8A",color:"#000000"},{"background-color":"#00D100",color:"#FFFFFF"},{"background-color":"#007500",color:"#FFFFFF"}]},4:{name:"Purple",colors:[{"background-color":"#CC85FF",color:"#000000"},{"background-color":"#7700CC",color:"#FFFFFF"},{"background-color":"#3E006B",color:"#FFFFFF"}]},5:{name:"Orange",colors:[{"background-color":"#FFCA8A",color:"#000000"},{"background-color":"#FFA12E",color:"#000000"},{"background-color":"#D67600",color:"#000000"}]}};Ie.defaults.baseURL="/api";const v=Ie.create({headers:{Accept:"application/json","Content-Type":"application/json",Authorization:null}});v.interceptors.response.use(e=>e.data,e=>(X({title:"Error",message:e.toString(),type:"error"}),Promise.reject(e)));v.interceptors.request.use(e=>e,e=>(X({title:"Error",message:e.toString(),type:"error"}),Promise.reject(e)));var J={list(){return v.get("hilt/projects/")},get(e){return v.get(`hilt/projects/${e}/`)},create(e){return v.post("hilt/projects/",e)},update(e){return v.put(`hilt/projects/${e.id}/`,e)},delete(e){return v.delete(`hilt/projects/${e}/`)},exportJSON(e){return v.get(`hilt/export/json/${e}/`)}};const F=O({id:"project",state:()=>({projectInfo:null}),getters:{getProjectInfo:e=>e.projectInfo,task:e=>e.projectInfo.task},actions:{reset_state(){J.get(this.projectInfo.id).then(e=>(console.log("reset_project_state",e),this.projectInfo=e,e),e=>{console.log(e)})},setProject(e){this.projectInfo=e},setTask(e){this.projectInfo.task=e},exportJSON(){return J.exportJSON(this.projectInfo.id)}}}),ht={name:"CreateProjectModal",props:{dialogVisible:Boolean,existingInfo:Object},setup(){const e=F(),t=[];for(let s in U)t.push({id:s,name:U[s]});return{projectStore:e,taskOptions:t}},data(){return{projectInfo:{name:"",description:"",task:""},formRules:{name:[{required:!0,message:"Please input project name",trigger:"blur"}],description:[{required:!0,message:"Please input description",trigger:"blur"}],task:[{required:!0,message:"Please select task",trigger:"blur"}]}}},methods:{dialogIsOpen(){if(this.existingInfo)for(let e in this.existingInfo)this.projectInfo[e]=this.existingInfo[e];else this.projectInfo={name:"",description:"",task:""}},createProject(){this.$refs.projectInfoForm.validate(e=>{if(e){let t;this.existingInfo?t=J.update(this.projectInfo):t=J.create(this.projectInfo),t.then(s=>{this.projectStore.setProject(s),this.$emit("update:dialogVisible",!1),this.$router.push({name:"DocumentUpload"})})}})}}},ft={class:"dialog-footer"},gt=p("Cancel"),yt=p("Confirm");function St(e,t,s,i,l,a){const c=r("el-input"),u=r("el-form-item"),h=r("el-option"),m=r("el-select"),f=r("el-form"),y=r("el-button"),w=r("el-dialog");return _(),b(w,{title:this.existingInfo?"Edit Existing Project":"Create New Project",modelValue:s.dialogVisible,"onUpdate:modelValue":t[4]||(t[4]=g=>s.dialogVisible=g),"onUpdate:visible":t[5]||(t[5]=g=>e.$emit("update:dialogVisible",g)),onOpen:this.dialogIsOpen,width:"40%"},{footer:n(()=>[d("span",ft,[o(y,{onClick:t[3]||(t[3]=()=>e.$emit("update:dialogVisible",!1))},{default:n(()=>[gt]),_:1}),o(y,{type:"primary",onClick:a.createProject},{default:n(()=>[yt]),_:1},8,["onClick"])])]),default:n(()=>[o(f,{model:l.projectInfo,rules:l.formRules,ref:"projectInfoForm"},{default:n(()=>[o(u,{label:"Name",prop:"name"},{default:n(()=>[o(c,{modelValue:l.projectInfo.name,"onUpdate:modelValue":t[0]||(t[0]=g=>l.projectInfo.name=g)},null,8,["modelValue"])]),_:1}),o(u,{label:"Description",prop:"description"},{default:n(()=>[o(c,{modelValue:l.projectInfo.description,"onUpdate:modelValue":t[1]||(t[1]=g=>l.projectInfo.description=g)},null,8,["modelValue"])]),_:1}),o(u,{label:"Task",prop:"task"},{default:n(()=>[o(m,{remote:"",modelValue:l.projectInfo.task,"onUpdate:modelValue":t[2]||(t[2]=g=>l.projectInfo.task=g),placeholder:"Select",style:{width:"100%"}},{default:n(()=>[(_(!0),D(T,null,M(i.taskOptions,g=>(_(),b(h,{key:g.id,label:g.name,value:g.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue","onOpen"])}var bt=C(ht,[["render",St]]);const xt={name:"ProjectsPage",components:{CreateProjectModal:bt,Edit:$e,Delete:le},setup(){const e=z(),t=F(),s=[];for(let i in U)s.push({text:U[i],value:U[i]});return{userStore:e,projectStore:t,filters:s}},data(){return{projects:[],dialogVisible:!1,selectedProject:null}},created:function(){this.fetchProjects()},methods:{handleProjectSelected(e,t){this.$router.push({name:"DocumentList"}),this.projectStore.setProject(t)},handleEdit(e,t){this.selectedProject=t,this.dialogVisible=!0},handleDelete(e,t){J.delete(t.id).then(()=>{this.fetchProjects()})},fetchProjects(){J.list().then(e=>{this.projects=e.results},e=>{console.log(e)})},dateFormat(e,t){let s=e[t.property];return s?Ue.fromISO(s).toISODate():""},convertTaskIDToString(e,t){let s=e[t.property];return s?U[s]:""},filterTask(e,t,s){let i=t[s.property],l=U[i];return e===l}}},Dt={style:{"text-align":"center"}},wt=p("CREATE PROJECT "),vt=p(" Edit "),kt=p("Delete");function It(e,t,s,i,l,a){const c=r("el-button"),u=r("el-col"),h=r("el-row"),m=r("el-link"),f=r("el-table-column"),y=r("Edit"),w=r("el-icon"),g=r("Delete"),k=r("el-popconfirm"),I=r("el-table"),x=r("CreateProjectModal");return _(),D("div",null,[d("div",Dt,[d("h1",null,"Hello, "+P(this.userStore.username),1),o(h,null,{default:n(()=>[o(u,{span:12,offset:6},{default:n(()=>[o(c,{type:"primary",onClick:t[0]||(t[0]=()=>{this.selectedProject=null,this.dialogVisible=!0})},{default:n(()=>[wt]),_:1})]),_:1})]),_:1})]),o(h,null,{default:n(()=>[o(u,{span:12,offset:6},{default:n(()=>[o(I,{data:l.projects,stripe:"","default-sort":{prop:"updated_at",order:"descending"}},{default:n(()=>[o(f,{prop:"name",label:"Name",sortable:""},{default:n(S=>[o(m,{type:"primary",onClick:W=>a.handleProjectSelected(S.$index,S.row)},{default:n(()=>[p(P(S.row.name),1)]),_:2},1032,["onClick"])]),_:1}),o(f,{prop:"description",label:"Description",sortable:""}),o(f,{prop:"task",label:"Task",formatter:a.convertTaskIDToString,sortable:"",filters:this.filters,"filter-method":a.filterTask},null,8,["formatter","filters","filter-method"]),o(f,{prop:"updated_at",label:"Last Updated",formatter:a.dateFormat,sortable:""},null,8,["formatter"]),o(f,{label:"Operations"},{default:n(S=>[o(c,{size:"small",onClick:W=>a.handleEdit(S.$index,S.row)},{default:n(()=>[o(w,null,{default:n(()=>[o(y)]),_:1}),vt]),_:2},1032,["onClick"]),o(k,{title:"Are you sure?",onConfirm:W=>a.handleDelete(S.$index,S.row),style:{"margin-left":"10px"}},{reference:n(()=>[o(c,{size:"small",type:"danger"},{default:n(()=>[o(w,null,{default:n(()=>[o(g)]),_:1}),kt]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1}),o(x,{"dialog-visible":l.dialogVisible,"onUpdate:dialog-visible":t[1]||(t[1]=S=>l.dialogVisible=S),"existing-info":this.selectedProject},null,8,["dialog-visible","existing-info"])])}var $t=C(xt,[["render",It]]);const Ct={name:"SetupSideBar",components:{Files:Oe,UploadFilled:pe,MessageBox:ze,StarFilled:Ne,Edit:$e,Download:Ce,DataAnalysis:je,Tools:Fe},computed:{disabled(){return this.projectStore.getProjectInfo,!1}},setup(){return{projectStore:F()}}},ee=e=>(N("data-v-1f5238c3"),e=e(),R(),e),jt=ee(()=>d("span",null,"Setup",-1)),Ft=p(" Overview "),Pt=p(" Upload New Document "),Lt=p(" Upload Custom Model "),Wt=ee(()=>d("span",null,"Labels",-1)),Tt=ee(()=>d("span",null,"Generate Explanations",-1)),Mt=ee(()=>d("span",null,"Debug",-1)),At=ee(()=>d("span",null,"Export Data",-1));function Bt(e,t,s,i,l,a){const c=r("Tools"),u=r("el-icon"),h=r("Files"),m=r("el-menu-item"),f=r("UploadFilled"),y=r("StarFilled"),w=r("el-sub-menu"),g=r("DataAnalysis"),k=r("el-menu"),I=r("Edit"),x=r("Download"),S=r("el-col");return _(),b(S,null,{default:n(()=>[o(k,{"default-active":e.$route.path,router:!0},{default:n(()=>[o(w,{index:"1"},{title:n(()=>[o(u,null,{default:n(()=>[o(c)]),_:1}),jt]),default:n(()=>[o(m,{index:"/project/doc/list"},{default:n(()=>[o(u,null,{default:n(()=>[o(h)]),_:1}),Ft]),_:1}),o(m,{index:"/project/doc/upload",disabled:a.disabled},{default:n(()=>[o(u,null,{default:n(()=>[o(f)]),_:1}),Pt]),_:1},8,["disabled"]),o(m,{index:"/project/doc/model",disabled:a.disabled},{default:n(()=>[o(u,null,{default:n(()=>[o(f)]),_:1}),Lt]),_:1},8,["disabled"]),o(m,{index:"/project/labels"},{default:n(()=>[o(u,null,{default:n(()=>[o(y)]),_:1}),Wt]),_:1})]),_:1}),o(m,{index:"/project/generate-explanations"},{default:n(()=>[o(u,null,{default:n(()=>[o(g)]),_:1}),Tt]),_:1})]),_:1},8,["default-active"]),o(k,null,{default:n(()=>[o(m,{onClick:t[0]||(t[0]=()=>this.$router.push({name:"DebugOverview"}))},{default:n(()=>[o(u,null,{default:n(()=>[o(I)]),_:1}),Mt]),_:1})]),_:1}),o(k,{"default-active":e.$route.path,router:!0},{default:n(()=>[o(m,{index:"/project/export"},{default:n(()=>[o(u,null,{default:n(()=>[o(x)]),_:1}),At]),_:1})]),_:1},8,["default-active"])]),_:1})}var Vt=C(Ct,[["render",Bt],["__scopeId","data-v-1f5238c3"]]);const Et={name:"ProjectSetupPage",components:{SetupSideBar:Vt}};function Ut(e,t,s,i,l,a){const c=r("SetupSideBar"),u=r("el-aside"),h=r("router-view"),m=r("el-main"),f=r("el-container");return _(),D("div",null,[o(f,null,{default:n(()=>[o(u,{style:{"border-right":"solid 1px #e6e6e6"}},{default:n(()=>[o(c,{style:{width:"100%"}})]),_:1}),o(m,null,{default:n(()=>[o(h)]),_:1})]),_:1})])}var Ot=C(Et,[["render",Ut]]);const zt={name:"SetupDocument"};function Nt(e,t,s,i,l,a){const c=r("router-view");return _(),b(c)}var Rt=C(zt,[["render",Nt]]),q={list(e,t,s){const i={};return t&&(i.page=t),s&&(i.page_size=s),v.get(`hilt/projects/${e}/docs/`,{params:i})},uploadFile(e,t,s){const i=new FormData;return i.append("dataset",t),i.append("format",s.toLowerCase()),v.post(`hilt/projects/${e}/docs/upload/`,i,{headers:Z(V({},v.defaults.headers),{"Content-Type":"multipart/form-data"})})},markAnnotated(e,t){return console.log("documents API",e,":	",t),v.put(`hilt/projects/${e}/docs/${t}/`,{annotated:!0})},delete(e,t){return v.delete(`hilt/projects/${e}/docs/${t}/`)},detailedDocument(e,t){return v.get(`hilt/projects/${e}/docs/${t}/words-annotations/`)}};const te=O({id:"document",state:()=>({documents:[],curPage:1,maxPage:1,totalDocCount:0,curDocIndex:0,annotatedDocCount:0,pageSize:10}),getters:{getDocuments:e=>e.documents,getdocumentInfo:e=>e},actions:{resetState(){return this.curPage=1,this.pageSize=10,this.fetchDocuments()},setCurDocIndex(e){this.curDocIndex=e},fetchDocuments(){const e=F();return q.list(e.getProjectInfo.id,this.curPage,this.pageSize).then(t=>(this.documents=t.results.results,this.totalDocCount=t.count,this.annotatedDocCount=t.results.annotatedCount,this.maxPage=Math.ceil(this.totalDocCount/this.pageSize),t))},updateCurPage(e){return this.curPage=e,this.curDocIndex=0,this.fetchDocuments()},deleteDocument(e){const t=F();return q.delete(t.getProjectInfo.id,e.id)},markAnnotated(){const e=F();return this.documents[this.curDocIndex].id?(console.log(e.getProjectInfo.id,this.documents[this.curDocIndex].id),q.markAnnotated(e.getProjectInfo.id,this.documents[this.curDocIndex].id).then(()=>{this.document[this.curDocIndex].annotated=!0})):null}}}),Gt={name:"DocumentList",components:{Search:me,Delete:le},setup(){return{documentStore:te()}},data(){return{searchQuery:""}},methods:{pageChanged(e){this.documentStore.updateCurPage(e)},indexMethod(e){return e+1},percentageText(e){return`${e} % annotated`},handleDelete(e,t){this.documentStore.deleteDocument(t).then(()=>{this.documentStore.fetchDocuments()})}},created(){this.documentStore.resetState()},computed:{percentageCompleted(){const e=this.documentStore.getdocumentInfo;if(!e)return 0;const t=e.annotatedDocCount,s=e.totalDocCount,i=t/s*100;return i||0}}},qt={style:{"text-align":"center"}},Qt=d("div",null,[d("h1",null,"All Uploaded Documents")],-1),Jt={style:{"align-content":"center"}},Ht=p("Delete");function Kt(e,t,s,i,l,a){const c=r("Search"),u=r("el-icon"),h=r("el-input"),m=r("el-table-column"),f=r("Delete"),y=r("el-button"),w=r("el-popconfirm"),g=r("el-table"),k=r("el-pagination"),I=se("snip");return _(),D("div",null,[d("div",qt,[Qt,o(h,{modelValue:l.searchQuery,"onUpdate:modelValue":t[0]||(t[0]=x=>l.searchQuery=x),placeholder:"Type to search for documents",style:{width:"50%"},clearable:""},{prefix:n(()=>[d("div",Jt,[o(u,null,{default:n(()=>[o(c)]),_:1})])]),_:1},8,["modelValue"])]),o(g,{data:i.documentStore.getDocuments.filter(x=>!l.searchQuery||x.text.toLowerCase().includes(l.searchQuery.toLowerCase().trim())),stripe:""},{default:n(()=>[o(m,{type:"index",index:a.indexMethod},null,8,["index"]),o(m,{label:"Text"},{default:n(x=>[ie((_(),D("p",null,[p(P(x.row.text),1)])),[[I,{lines:3}]])]),_:1}),o(m,{label:"Operations"},{default:n(x=>[o(w,{title:"Are you sure?",onConfirm:S=>a.handleDelete(x.$index,x.row),style:{"margin-left":"10px"}},{reference:n(()=>[o(y,{size:"small",type:"danger"},{default:n(()=>[o(u,null,{default:n(()=>[o(f)]),_:1}),Ht]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"]),o(k,{background:"",layout:"prev, pager, next",total:i.documentStore.getdocumentInfo.totalDocCount,"page-size":i.documentStore.getdocumentInfo.pageSize,"current-page":i.documentStore.getdocumentInfo.curPage,onCurrentChange:a.pageChanged,style:{"text-align":"center"}},null,8,["total","page-size","current-page","onCurrentChange"])])}var Zt=C(Gt,[["render",Kt]]);const Xt={name:"DocumentUpload",components:{UploadFilled:pe},setup(){return{projectStore:F()}},data(){return{fileForm:{fileType:"JSON"}}},methods:{uploadFile(e){q.uploadFile(this.projectStore.getProjectInfo.id,e.file,this.fileForm.fileType).then(()=>{this.$router.push({name:"Labels"})}).catch(t=>{console.log(t)})}}},A=e=>(N("data-v-94cda20c"),e=e(),R(),e),Yt=A(()=>d("h3",null,"Import your corpus below",-1)),eo=A(()=>d("div",null,[p(" In order to start the annotation process, a corpus "),d("u",null,"must"),p(" be uploaded ")],-1)),to=A(()=>d("div",null,"We accept datasets in the following formats:",-1)),oo=A(()=>d("b",null,"JSON (recommended)",-1)),no=A(()=>d("br",null,null,-1)),ro=A(()=>d("u",null,"Format:",-1)),lo={style:{width:"fit-content","padding-left":"20px","padding-right":"20px",height:"fit-content"}},so=p("                "),io=p(`
{
  "data" : [
    {
      "text" : "Louis Armstrong the great trumpet player lived in Corona.",
      "words": ["Louis", "Armstrong", "the", "great", "trumpet", "player", "lived", "in", "Corona."],
      "annotations": [
        {
    `),ao=p(`
          "label": "Label-Name-1"
    `),co=p(`
          "label": "Label-Name-1",
          "start_offset": 0,
          "end_offset": 5,
    `),uo=p(`
        }
      ]
    },
    ...
  ]
}
              `),_o=p(`
							`),po=p(" Each entry within "),mo=A(()=>d("i",null,"data",-1)),ho=p(" must have keys "),fo=A(()=>d("i",null,[d("b",null,"text")],-1)),go=p(" and "),yo=A(()=>d("i",null,[d("b",null,"words")],-1)),So=p(". All other keys will be saved in a metadata dictionary associated with the text "),bo=A(()=>d("br",null,null,-1)),xo=p(" The "),Do=A(()=>d("i",null,[d("b",null,"annotations")],-1)),wo=p(" key in each entry is optional. And, can be used to populate the document with label. "),vo=p("JSON file"),ko=A(()=>d("div",{class:"el-upload__text"},[p(" Drop file here or "),d("em",null,"click to upload")],-1));function Io(e,t,s,i,l,a){const c=r("el-radio"),u=r("el-form-item"),h=r("UploadFilled"),m=r("el-icon"),f=r("el-upload"),y=r("el-form"),w=r("el-card"),g=r("el-col"),k=r("el-row");return _(),b(k,null,{default:n(()=>[o(g,null,{default:n(()=>[o(w,null,{header:n(()=>[Yt]),default:n(()=>[d("div",null,[eo,to,d("ul",null,[d("li",null,[oo,no,ro,d("pre",lo,[so,d("code",null,[io,this.projectStore.task===1?(_(),D(T,{key:0},[ao],64)):j("",!0),this.projectStore.task===2?(_(),D(T,{key:1},[co],64)):j("",!0),uo]),_o]),po,mo,ho,fo,go,yo,So,bo,xo,Do,wo])])]),o(y,{model:this.fileForm,style:{"text-align":"center"}},{default:n(()=>[o(u,null,{default:n(()=>[o(c,{modelValue:l.fileForm.fileType,"onUpdate:modelValue":t[0]||(t[0]=I=>l.fileForm.fileType=I),label:"JSON",border:""},{default:n(()=>[vo]),_:1},8,["modelValue"])]),_:1}),o(u,{label:""},{default:n(()=>[o(f,{"http-request":a.uploadFile,drag:"",accept:"text/json",ref:"uploadInput",action:""},{default:n(()=>[o(m,{size:48},{default:n(()=>[o(h)]),_:1}),ko]),_:1},8,["http-request"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1})]),_:1})}var $o=C(Xt,[["render",Io],["__scopeId","data-v-94cda20c"]]),ne={list(e){return v.get(`hilt/projects/${e}/models/`)},uploadModel(e,t,s){const i=new FormData;return i.append("model_zip",t),i.append("format",s.toLowerCase()),console.log(i),v.post(`hilt/projects/${e}/models/upload/`,i,{headers:Z(V({},v.defaults.headers),{"Content-Type":"multipart/form-data"})})}};const Co={name:"ModelUpload",components:{UploadFilled:pe,Upload:Re,SuccessFilled:Ge},setup(){return{projectStore:F()}},data(){return{modelRadio:"Upload Model",modelList:[],fileForm:{fileType:".zip",fileZip:[],file:null},savingSuccessful:!1}},methods:{handleUpload(e){ne.uploadModel(this.projectStore.getProjectInfo.id,e.file,this.fileForm.fileType).then(t=>{console.log(t),t!=null&&t.success&&(this.savingSuccessful=!0)}).catch(t=>{console.log(t)})},uploadFile(){this.$refs.modelUploadForm.validate(e=>{e&&ne.uploadModel(this.projectStore.getProjectInfo.id,this.fileForm.file,this.fileForm.description,this.fileForm.fileType).then(()=>{}).catch(t=>{console.log(t)})})},getModelList(){ne.list(this.projectStore.getProjectInfo.id).then(e=>{this.modelList=e.results,console.log("res",e),console.log("model list:",this.modelList)})},created(){this.getModelList()}}},fe=e=>(N("data-v-01cd78d0"),e=e(),R(),e),jo=fe(()=>d("h3",null,"Model List",-1)),Fo=fe(()=>d("h3",null,[p("Upload new model "),d("span",{style:{color:"#909399"}},"(Optional)")],-1)),Po=p(".ZIP file"),Lo=fe(()=>d("div",{class:"el-upload__text"},[p(" Drop file here or "),d("em",null,"click to upload")],-1)),Wo={key:0,class:"success",style:{color:"green"}},To=p("Model was saved successfully ");function Mo(e,t,s,i,l,a){const c=r("el-table-column"),u=r("el-table"),h=r("el-card"),m=r("el-radio"),f=r("el-form-item"),y=r("UploadFilled"),w=r("el-icon"),g=r("el-upload"),k=r("SuccessFilled"),I=r("el-form"),x=r("el-col"),S=r("el-row");return _(),b(S,null,{default:n(()=>[o(x,null,{default:n(()=>[l.modelRadio=="Model List"?(_(),b(h,{key:0},{header:n(()=>[jo]),default:n(()=>[o(u,{data:this.modelList,stripe:"",style:{width:"100%"}},{default:n(()=>[o(c,{prop:"id",label:"Id"}),o(c,{prop:"name",label:"Name"}),o(c,{prop:"model",label:"Model path"}),o(c,{prop:"uploaded_at",label:"Uploaded at"})]),_:1},8,["data"])]),_:1})):j("",!0),l.modelRadio=="Upload Model"?(_(),b(h,{key:1},{header:n(()=>[Fo]),default:n(()=>[o(I,{model:this.fileForm,ref:"modelUploadForm",style:{"text-align":"center"}},{default:n(()=>[o(f,null,{default:n(()=>[o(m,{modelValue:l.fileForm.fileType,"onUpdate:modelValue":t[0]||(t[0]=W=>l.fileForm.fileType=W),label:".zip",border:""},{default:n(()=>[Po]),_:1},8,["modelValue"])]),_:1}),o(f,null,{default:n(()=>[o(g,{"file-list":l.fileForm.fileZip,"onUpdate:file-list":t[1]||(t[1]=W=>l.fileForm.fileZip=W),drag:"",accept:".zip",ref:"uploadInput",action:"","http-request":a.handleUpload},{default:n(()=>[o(w,{size:48},{default:n(()=>[o(y)]),_:1}),Lo]),_:1},8,["file-list","http-request"])]),_:1}),l.savingSuccessful?(_(),D("div",Wo,[d("p",null,[To,o(w,null,{default:n(()=>[o(k)]),_:1})])])):j("",!0)]),_:1},8,["model"])]),_:1})):j("",!0)]),_:1})]),_:1})}var Ao=C(Co,[["render",Mo],["__scopeId","data-v-01cd78d0"]]),ve={list(e){return v.get(`hilt/projects/${e}/labels/?page_size=100`)},update(e,t){return v.put(`hilt/projects/${e}/labels/${t.id}/`,t)}};const H=O({id:"label",state:()=>({labels:[],labelsMap:{}}),getters:{getLabels:e=>e.labels,getLabelByID:e=>t=>!t||!(t in e.labelsMap)?null:e.labels[e.labelsMap[t]]},actions:{fetchLabels(){const e=F();return ve.list(e.getProjectInfo.id).then(t=>{const s={};for(let i=0;i<t.results.length;i++){const l=t.results[i];s[l.id]=i}return this.labels=t.results,this.labelsMap=s,t.results})},updateLabel(e){const t=F();return ve.update(t.getProjectInfo.id,e)}}}),Bo={name:"LabelModificationPage",components:{QuestionFilled:qe},setup(){const e=H(),t=[];for(let s in G)t.push({id:s,name:G[s].name});return{labelStore:e,colorSetOptions:t}},data(){return{existingLabels:[],colors_sets:[],saving:!1}},methods:{goNextStep(){this.saving=!0;const e=[];for(let t=0;t<this.existingLabels.length;t++){const s=this.existingLabels[t],i=parseInt(this.colors_sets[t]);s.color_set!=i&&(s.color_set=i,e.push(this.labelStore.updateLabel(s)))}Promise.all(e).then(()=>{this.saving=!1,this.labelStore.fetchLabels(),this.$router.push({name:"GenerateExplanations"})})},getColors(e){return e=parseInt(e),e in G?G[e].colors:[]}},created(){this.labelStore.fetchLabels().then(e=>{const t={};for(let s in e)t[s]=""+e[s].color_set;this.colors_sets=t,this.existingLabels=e})},computed:{disableButton(){if(this.saving)return!0;const e={};for(let t in this.colors_sets){if(t in e)return!0;e[t]=null}return!1}}},Vo=d("h3",null,"Label Space Creation",-1),Eo={style:{"text-align":"left"}},Uo=d("b",null,"Current Label Space",-1),Oo={style:{"margin-left":"5px"}},zo=p(" Done ");function No(e,t,s,i,l,a){const c=r("QuestionFilled"),u=r("el-icon"),h=r("el-popover"),m=r("el-col"),f=r("el-row"),y=r("el-divider"),w=r("el-option"),g=r("el-select"),k=r("el-form-item"),I=r("el-button"),x=r("el-form"),S=r("el-card");return _(),b(f,{style:{width:"100%"}},{default:n(()=>[o(S,{style:{width:"100%"}},{header:n(()=>[Vo]),default:n(()=>[d("div",Eo,[o(f,null,{default:n(()=>[o(m,{span:8},{default:n(()=>[o(h,{content:"Available labels for model to predict.",trigger:"hover"},{reference:n(()=>[d("span",null,[Uo,o(u,{style:{"margin-left":"5px"}},{default:n(()=>[o(c)]),_:1})])]),_:1})]),_:1})]),_:1}),o(y),o(x,{model:l.colors_sets},{default:n(()=>[(_(!0),D(T,null,M(this.existingLabels,(W,L)=>(_(),b(f,{key:W.id},{default:n(()=>[o(k,{label:W.text},{default:n(()=>[o(g,{modelValue:this.colors_sets[L],"onUpdate:modelValue":B=>this.colors_sets[L]=B,placeholder:"Select",style:{width:"100%"}},{default:n(()=>[(_(!0),D(T,null,M(this.colorSetOptions,B=>(_(),b(w,{key:B.id,label:B.name,value:B.id},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"]),d("div",Oo,[(_(!0),D(T,null,M(this.getColors(this.colors_sets[L]),(B,oe)=>(_(),D("span",{key:oe,style:Q([B,{"margin-left":"5px",padding:"5px"}])}," Word ",4))),128))])]),_:2},1024))),128)),o(f,null,{default:n(()=>[o(I,{type:"success",disabled:this.disableButton,onClick:a.goNextStep},{default:n(()=>[zo]),_:1},8,["disabled","onClick"])]),_:1})]),_:1},8,["model"])])]),_:1})]),_:1})}var Ro=C(Bo,[["render",No]]),de={generateExplanations(e,t,{str:s,model_id:i,model_path:l}={}){console.log("inside network/explanations.js");const a=new FormData;return a.append("useHuggingface",t),t?a.append("str",s):(a.append("model_id",i),a.append("model_path",l)),console.log(a),v.post(`hilt/projects/${e}/explanations/`,a,{headers:Z(V({},v.defaults.headers),{"Content-Type":"multipart/form-data"})})},didFinishGeneration(e){return v.get(`hilt/projects/${e}/update/model_status/`)}};const Go={name:"GenerateExplanations",components:{Tools:Fe},setup(){return{projectStore:F()}},data(){return{generating_explanations:!1,huggingfaceForm:{str:"",rules:{str:{required:!0,message:"Please input huggingface string",trigger:"blur"}}},customModelForm:{modelList:[],select:"",rules:{select:{required:!0,message:"Please select model",trigger:"change"}}}}},methods:{getModelList(){console.log("model list"),ne.list(this.projectStore.getProjectInfo.id).then(e=>{this.customModelForm.modelList=e.results})},huggingfaceSubmit(){this.$refs.huggingfaceForm.validate(e=>{e&&(console.log("huggingface generate explanations"),de.generateExplanations(this.projectStore.getProjectInfo.id,!0,{str:this.huggingfaceForm.str}).then(t=>{console.log("Here"),console.log(t),this.generating_explanations=!0,this.waitForCompletion(),X({title:"Explanation Generation Started",message:"Page will automatically change once task is completed",type:"success",duration:0})}).catch(t=>{t.response&&t.response.data?this.$notify.error({title:"Model training failed",message:t.response.data}):this.$notify.error({title:"Model failed to start training",message:"Please try again later"})}))})},customModelSubmit(){this.$refs.customModelForm.validate(e=>{e&&(console.log("custom model generate explanations"),console.log("model_id:",this.customModelForm.select[0]),console.log("model_path",this.customModelForm.select[1]),X({title:"Started",message:"Task accepted",type:"success",duration:4500}),de.generateExplanations(this.projectStore.getProjectInfo.id,!1,{model_id:this.customModelForm.select[0],model_path:this.customModelForm.select[1]}).then(t=>{const s=this.projectStore.getProjectInfo;this.projectStore.reset_state(),console.log(s.explanations_status),console.log(t),this.generating_explanations=!0,this.waitForCompletion(),X({title:"Explanation Generation Started",message:"Page will automatically change once task is",type:"success",duration:0})}).catch(t=>{console.log(t),t.response&&t.response.data?this.$notify.error({title:"Model training failed",message:t.response.data}):this.$notify.error({title:"Model failed to start training",message:"Please try again later"})}))})},waitForCompletion(){let e=20,t=setInterval(()=>de.didFinishGeneration(this.projectStore.getProjectInfo.id).then(s=>{console.log(s),e<0||s.status=="finished"?(console.log("finished"),this.$notify.success({title:"Success",message:"Model Execution had been completed",duration:0}),clearInterval(t),this.$router.push({name:"DebugOverview"})):(console.log("Waiting for model finish message."),e-=1,console.log(e))}),1e3)}},mounted(){this.getModelList()}},qo=d("h3",null,"Generate Explanations Page",-1),Qo=p("Generate Explanations"),Jo=p("Generate Explanations");function Ho(e,t,s,i,l,a){const c=r("el-option"),u=r("el-select"),h=r("el-form-item"),m=r("el-button"),f=r("el-form"),y=r("el-alert"),w=r("el-tab-pane"),g=r("el-input"),k=r("el-col"),I=r("el-tabs"),x=r("el-card");return _(),b(x,{style:{width:"100%"}},{default:n(()=>[qo,o(I,{type:"border-card"},{default:n(()=>[o(w,{label:"Custom Model"},{default:n(()=>[o(f,{model:l.customModelForm,ref:"customModelForm",rules:l.customModelForm.rules,"label-position":"top"},{default:n(()=>[o(h,{label:"Custom Model",prop:"select"},{default:n(()=>[o(u,{modelValue:l.customModelForm.select,"onUpdate:modelValue":t[0]||(t[0]=S=>l.customModelForm.select=S),clearable:"",placeholder:"Select Model"},{default:n(()=>[(_(!0),D(T,null,M(l.customModelForm.modelList,S=>(_(),b(c,{key:S.id,label:S.name,value:[S.id,S.model]},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(h,null,{default:n(()=>[o(m,{type:"primary",onClick:a.customModelSubmit},{default:n(()=>[Qo]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"]),l.generating_explanations?(_(),b(y,{key:0,title:"Generating Explanations...",type:"info",description:"will update once the task in done",center:"","show-icon":"",closable:!1})):j("",!0)]),_:1}),o(w,{label:"Huggingface"},{default:n(()=>[o(f,{model:l.huggingfaceForm,ref:"huggingfaceForm",rules:l.huggingfaceForm.rules,"label-position":"top"},{default:n(()=>[o(h,{label:"huggingface string",prop:"str"},{default:n(()=>[o(k,{span:6},{default:n(()=>[o(g,{modelValue:l.huggingfaceForm.str,"onUpdate:modelValue":t[1]||(t[1]=S=>l.huggingfaceForm.str=S)},null,8,["modelValue"])]),_:1})]),_:1}),o(h,null,{default:n(()=>[o(m,{type:"primary",onClick:a.huggingfaceSubmit},{default:n(()=>[Jo]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1})]),_:1})}var Ko=C(Go,[["render",Ho]]);const Zo={name:"ExportData",components:{Download:Ce},setup(){return{projectStore:F()}},methods:{exportJSON(){this.projectStore.exportJSON().then(e=>{Qe(JSON.stringify(e,null,1),`${this.projectStore.getProjectInfo.name}.json`)})}}},Xo=d("h3",null,"Export Explanation-Generated Data",-1),Yo=p(" Download JSON data ");function en(e,t,s,i,l,a){const c=r("Download"),u=r("el-icon"),h=r("el-button");return _(),D(T,null,[Xo,o(h,{type:"primary",onClick:t[0]||(t[0]=m=>a.exportJSON())},{default:n(()=>[o(u,null,{default:n(()=>[o(c)]),_:1}),Yo]),_:1})],64)}var tn=C(Zo,[["render",en]]);const on={name:"SetupSideBar",components:{Back:ae,Document:Je,DocumentCopy:He,List:Ke,Management:Ze,DataAnalysis:je}},ge=e=>(N("data-v-6f811d76"),e=e(),R(),e),nn=ge(()=>d("span",null,"Back",-1)),rn=ge(()=>d("span",null,"Overview",-1)),ln=ge(()=>d("span",null,"Evaluation",-1));function sn(e,t,s,i,l,a){const c=r("Back"),u=r("el-icon"),h=r("el-menu-item"),m=r("Management"),f=r("DataAnalysis"),y=r("el-menu"),w=r("el-col");return _(),b(w,null,{default:n(()=>[o(y,{"default-active":e.$route.path},{default:n(()=>[o(h,{index:"1",onClick:t[0]||(t[0]=()=>this.$router.push({name:"DocumentList"}))},{default:n(()=>[o(u,null,{default:n(()=>[o(c)]),_:1}),nn]),_:1}),o(h,{index:"/debug/overview",onClick:t[1]||(t[1]=()=>this.$router.push({name:"DebugOverview"}))},{default:n(()=>[o(u,null,{default:n(()=>[o(m)]),_:1}),rn]),_:1}),o(h,{index:"/debug/evaluation",onClick:t[2]||(t[2]=()=>this.$router.push({name:"DebugEvaluation"}))},{default:n(()=>[o(u,null,{default:n(()=>[o(f)]),_:1}),ln]),_:1})]),_:1},8,["default-active"])]),_:1})}var an=C(on,[["render",sn],["__scopeId","data-v-6f811d76"]]);const ye=O({id:"detailedDocument",state:()=>({document:null,maxWords:50}),getters:{getDocument:e=>e.document,getMaxWords:e=>e.maxWords},actions:{fetchDocument(e){const t=F();return q.detailedDocument(t.getProjectInfo.id,e).then(s=>{const i={};for(let l of s.words){const a={};for(let c of l.word_annotation_score)a[c.annotation]=c,c.annotation in i||(i[c.annotation]=[]),i[c.annotation].push([c.score,c]);l.scores=a,delete l.word_annotation_score}for(let l in i){const a=i[l];a.sort((u,h)=>h[0]-u[0]);let c=0;for(let u=0;u<a.length;u++){const h=a[u];u>0&&a[u-1][0]!==h[0]&&(c=u),h[1].order=c}}this.document=s})}}});var ue={list(e,t){const s=t!==void 0?`&doc_id=${t}`:"";return v.get(`hilt/projects/${e}/dict/local/?page_size=10000`+s)},create(e,t){return v.post(`hilt/projects/${e}/dict/local/`,t)},delete(e,t){return v.delete(`hilt/projects/${e}/dict/local/${t}/`)}};const Se=O({id:"dictionary_local",state:()=>({documents:{}}),getters:{getByDocumentID:e=>t=>e.documents[t],fetchIfExists:e=>(t,s,i)=>{if(!(t in e.documents))return null;const l=e.documents[t];if(!(s in l))return null;const a=l[s];return i in a?a[i]:null}},actions:{fetchDictionary(e){const t=F();return ue.list(t.getProjectInfo.id,e).then(s=>{const i=s.results,l={};for(let a of i){const c=a.word.document;c in l||(l[c]={});const u=a.word.id;u in l[c]||(l[c][u]={});const h=a.annotation;l[c][u][h]=a}this.documents=l})},addWord(e,t){const s=F();return ue.create(s.getProjectInfo.id,t).then(()=>{this.fetchDictionary(e)})},deleteWord(e){const t=F();return ue.delete(t.getProjectInfo.id,e).then(()=>this.fetchDictionary())}}});const cn={name:"LocalSideBar",components:{Back:ae,Check:he},setup(){const e=te(),t=ye(),s=H(),i=Se();return{documentStore:e,detailedDocumentStore:t,labelStore:s,localDictionaryStore:i}},created(){const e=[];e.push(this.labelStore.fetchLabels()),e.push(this.documentStore.resetState().then(()=>this.localDictionaryStore.fetchDictionary(this.documentStore.getDocuments[this.documentStore.getdocumentInfo.curDocIndex].id))),Promise.all(e).then(()=>{this.detailedDocumentStore.fetchDocument(this.documentStore.getDocuments[this.documentStore.getdocumentInfo.curDocIndex].id)})},methods:{pageChanged(e){this.documentStore.updateCurPage(e).then(()=>{this.detailedDocumentStore.fetchDocument(this.documentStore.getDocuments[this.documentStore.getdocumentInfo.curDocIndex].id)})},goToDocument(e,t){this.documentStore.setCurDocIndex(e),this.detailedDocumentStore.fetchDocument(t.id),this.localDictionaryStore.fetchDictionary(t.id)}}},dn=e=>(N("data-v-18621a56"),e=e(),R(),e),un=dn(()=>d("span",null,"Back",-1)),_n={key:0},pn={key:1};function mn(e,t,s,i,l,a){const c=r("Back"),u=r("el-icon"),h=r("el-menu-item"),m=r("el-menu"),f=r("Check"),y=r("el-table-column"),w=r("el-link"),g=r("el-table"),k=r("el-pagination"),I=r("el-col"),x=se("snip");return _(),b(I,null,{default:n(()=>[o(m,null,{default:n(()=>[o(h,{onClick:t[0]||(t[0]=()=>this.$router.push({name:"DebugOverview"}))},{default:n(()=>[o(u,null,{default:n(()=>[o(c)]),_:1}),un]),_:1})]),_:1}),o(g,{data:i.documentStore.getDocuments},{default:n(()=>[o(y,{width:"40"},{default:n(S=>[S.row.annotated?(_(),D("span",_n,[o(u,null,{default:n(()=>[o(f)]),_:1})])):(_(),D("div",pn,P(S.$index+1),1))]),_:1}),o(y,{prop:"text"},{default:n(S=>[ie((_(),b(w,{onClick:W=>a.goToDocument(S.$index,S.row)},{default:n(()=>[p(P(S.row.text),1)]),_:2},1032,["onClick"])),[[x,{lines:3}]])]),_:1})]),_:1},8,["data"]),o(k,{background:"",layout:"prev, pager, next",total:i.documentStore.getdocumentInfo.totalDocCount,"page-size":i.documentStore.getdocumentInfo.pageSize,"current-page":i.documentStore.getdocumentInfo.curPage,onCurrentChange:a.pageChanged,style:{"text-align":"center"}},null,8,["total","page-size","current-page","onCurrentChange"])]),_:1})}var hn=C(cn,[["render",mn],["__scopeId","data-v-18621a56"]]),ke={list(e,t,s,i){const l={};return t&&(l.page=t),s!=null&&(l.page_size=s),i!=null&&(l.q=i),v.get(`hilt/projects/${e}/words/`,{params:l})},documents(e,t){return v.get(`hilt/projects/${e}/words/${t}/`)}};const be=O({id:"words",state:()=>({words:[],curPage:1,maxPage:1,totalWordCount:0,curWordIndex:0,pageSize:10,currDocuments:[],searchQuery:void 0,wordLoaded:!1}),getters:{getWords:e=>e.words,getWordInfo:e=>e,getCurrWord:e=>()=>e.words[e.curWordIndex]?e.words[e.curWordIndex].text:void 0,getDocuments:e=>e.currDocuments},actions:{resetState(e=void 0){return this.curPage=1,this.pageSize=10,this.currDocuments=[],this.searchQuery=e,this.fetchWords()},setCurWordIndex(e){this.curWordIndex=e},fetchWords(){const e=F();return ke.list(e.getProjectInfo.id,this.curPage,this.pageSize,this.searchQuery).then(t=>(this.words=t.results,this.totalWordCount=t.count,this.maxPage=Math.ceil(this.totalWordCount/this.pageSize),t))},updateCurPage(e){return this.curPage=e,this.curWordIndex=0,this.currDocuments=[],this.fetchWords()},fetchDocuments(){this.wordLoaded=!1;const e=F();return ke.documents(e.getProjectInfo.id,this.getCurrWord()).then(t=>{for(const s of t.results)for(let i of s.words){const l={};for(let a of i.word_annotation_score)l[a.annotation]=a;i.scores=l,delete i.word_annotation_score}this.currDocuments=t.results,this.wordLoaded=!0})}}});var _e={list(e,t){const s=t!==void 0?`&q=${t}`:"";return v.get(`hilt/projects/${e}/dict/global/?page_size=10000`+s)},create(e,t){return v.post(`hilt/projects/${e}/dict/global/`,t)},update(e,t){return v.put(`hilt/projects/${e}/dict/global/${t.id}/`,t)},delete(e,t){return v.delete(`hilt/projects/${e}/dict/global/${t}/`)}};const ce=O({id:"dictionary_global",state:()=>({words:{},wordRows:[]}),getters:{getWords:e=>e.words,getRows:e=>e.wordRows,containsWord:e=>t=>t in e.words},actions:{fetchDictionary(e=void 0){const t=F();return _e.list(t.getProjectInfo.id,e).then(s=>{const i=s.results,l={},a=[];for(let c of i)l[c.word]=a.length,a.push(c);this.words=l,this.wordRows=a})},addWord(e,t,s){const i=F();return _e.create(i.getProjectInfo.id,{word:e,modification_type:t,ground_truth_label:s}).then(l=>{this.words[e]=this.wordRows.length,this.wordRows.push(l)})},deleteWord(e){const t=F();return _e.delete(t.getProjectInfo.id,this.wordRows[this.words[e]].id).then(()=>this.fetchDictionary())}}});const fn={name:"GlobalSideBar",components:{Back:ae,Check:he,Search:me},setup(){const e=H(),t=be(),s=ce();return{labelStore:e,wordStore:t,globalDictionaryStore:s}},data(){return{searchQuery:""}},watch:{searchQuery:function(e,t){console.log(e),e===""?this.wordStore.resetState().then(()=>{this.wordStore.fetchDocuments()}):this.wordStore.resetState(e).then(()=>{this.wordStore.fetchDocuments()})}},created(){this.$route.query.q!==void 0&&(this.searchQuery=this.$route.query.q);const e=[];e.push(this.labelStore.fetchLabels()),e.push(this.globalDictionaryStore.fetchDictionary()),this.searchQuery===""?e.push(this.wordStore.resetState()):e.push(this.wordStore.resetState(this.searchQuery)),Promise.all(e).then(()=>{this.wordStore.fetchDocuments()})},methods:{tableRowStyle({row:e}){return this.globalDictionaryStore.containsWord(e.text)?this.globalDictionaryStore.getRows[this.globalDictionaryStore.getWords[e.text]].modification_type==0?{color:"white",backgroundColor:"#67C23A"}:{color:"white",backgroundColor:"#F56C6C"}:{}},pageChanged(e){this.wordStore.updateCurPage(e).then(()=>{this.wordStore.fetchDocuments()})},goToDocument(e){this.wordStore.setCurWordIndex(e),this.wordStore.fetchDocuments()}}},gn=e=>(N("data-v-5cdc2f13"),e=e(),R(),e),yn=gn(()=>d("span",null,"Back",-1)),Sn={style:{"align-content":"center"}},bn={key:0},xn={key:1};function Dn(e,t,s,i,l,a){const c=r("Back"),u=r("el-icon"),h=r("el-menu-item"),m=r("el-menu"),f=r("Search"),y=r("el-input"),w=r("Check"),g=r("el-table-column"),k=r("el-link"),I=r("el-table"),x=r("el-pagination"),S=r("el-col"),W=se("snip");return _(),b(S,null,{default:n(()=>[o(m,null,{default:n(()=>[o(h,{onClick:t[0]||(t[0]=()=>this.$router.push({name:"DebugOverview"}))},{default:n(()=>[o(u,null,{default:n(()=>[o(c)]),_:1}),yn]),_:1})]),_:1}),o(y,{modelValue:l.searchQuery,"onUpdate:modelValue":t[1]||(t[1]=L=>l.searchQuery=L),placeholder:"Type to search for words",style:{"margin-top":"20px",width:"90%"},clearable:""},{prefix:n(()=>[d("div",Sn,[o(u,null,{default:n(()=>[o(f)]),_:1})])]),_:1},8,["modelValue"]),o(I,{data:Array.from(i.wordStore.getWords),"row-style":a.tableRowStyle},{default:n(()=>[o(g,{width:"40"},{default:n(L=>[i.globalDictionaryStore.containsWord(L.row.text)?(_(),D("span",bn,[o(u,null,{default:n(()=>[o(w)]),_:1})])):(_(),D("div",xn,P(i.wordStore.getWordInfo.pageSize*(i.wordStore.getWordInfo.curPage-1)+L.$index+1),1))]),_:1}),o(g,{prop:"text"},{default:n(L=>[ie((_(),b(k,{key:L.row.text,onClick:B=>a.goToDocument(L.$index)},{default:n(()=>[p(P(L.row.text),1)]),_:2},1032,["onClick"])),[[W,{lines:3}]])]),_:1})]),_:1},8,["data","row-style"]),o(x,{background:"",layout:"prev, pager, next",total:i.wordStore.getWordInfo.totalWordCount,"page-size":i.wordStore.getWordInfo.pageSize,"current-page":i.wordStore.getWordInfo.curPage,onCurrentChange:a.pageChanged,style:{"text-align":"center"}},null,8,["total","page-size","current-page","onCurrentChange"])]),_:1})}var wn=C(fn,[["render",Dn],["__scopeId","data-v-5cdc2f13"]]);const vn={name:"DebugPage",components:{OverviewSideBar:an,LocalSideBar:hn,GlobalSideBar:wn}};function kn(e,t,s,i,l,a){const c=r("OverviewSideBar"),u=r("LocalSideBar"),h=r("GlobalSideBar"),m=r("el-aside"),f=r("router-view"),y=r("el-main"),w=r("el-container");return _(),D("div",null,[o(w,null,{default:n(()=>[o(m,{style:{"border-right":"solid 1px #e6e6e6"}},{default:n(()=>[this.$route.path.endsWith("/overview")||this.$route.path.endsWith("/dictionary")||this.$route.path.endsWith("/evaluation")?(_(),b(c,{key:0,style:{width:"100%"}})):j("",!0),this.$route.path.endsWith("/local")?(_(),b(u,{key:1,style:{width:"100%"}})):j("",!0),this.$route.path.endsWith("/global")?(_(),b(h,{key:2,style:{width:"100%"}})):j("",!0)]),_:1}),o(y,null,{default:n(()=>[o(f)]),_:1})]),_:1})])}var In=C(vn,[["render",kn]]),We={train(e){return v.post(`hilt/projects/${e}/debug/training/`,{headers:V({},v.defaults.headers)})}};const $n={name:"DebugOverview",setup(){const e=F(),t=te(),s=ce(),i=be();return{projectStore:e,documentStore:t,globalDictionaryStore:s,wordStore:i}},created(){const e=[];e.push(this.globalDictionaryStore.fetchDictionary()),e.push(this.wordStore.resetState()),Promise.all(e).then(()=>{this.wordStore.fetchDocuments()})},methods:{getInstanceProgressBarLabel(){let e=this.documentStore.getdocumentInfo;return`${e.annotatedDocCount} / ${e.totalDocCount} documents annotated`},getTaskProgressBarLabel(){return`${this.globalDictionaryStore.getRows.length} / ${this.wordStore.getWordInfo.totalWordCount} documents annotated`},fetchDebugScores(e){return q.detailedDocument(this.projectStore.getProjectInfo.id,e).then(t=>{console.log(t),console.log(t.words);for(let s of t.words)console.log("word:",s.text),console.log("initial score:",s.word_annotation_score[0].score)})},trainDebugModel(){We.train(this.projectStore.getProjectInfo.id),this.fetchDebugScores(this.documentStore.getDocuments[1].id)}},computed:{instanceAnnotationCompletionPercentage(){let e=this.documentStore.getdocumentInfo;return e.totalDocCount==0?0:100*e.annotatedDocCount/e.totalDocCount},taskAnnotationCompletionPercentage(){let e=this.wordStore.getWordInfo;return e.totalWordCount==0?0:100*Array.from(this.globalDictionaryStore.getRows).length/e.totalWordCount}}},Cn=d("h3",null,"Debug Overview Page",-1),jn=p(" Start Debug Training "),Fn=p(),Pn=d("br",null,null,-1),Ln=d("span",{style:{"padding-right":"1em"}},"Instance Explanation",-1),Wn=p(" Start Annotating "),Tn=d("span",{style:{"padding-right":"1em"}},"Task Explanation",-1),Mn=p(" Start Annotating ");function An(e,t,s,i,l,a){const c=r("el-button"),u=r("el-progress"),h=r("el-row");return _(),D(T,null,[Cn,o(c,{type:"primary",onClick:t[0]||(t[0]=m=>a.trainDebugModel())},{default:n(()=>[jn]),_:1}),Fn,Pn,o(h,{style:{width:"100%","margin-top":"3em"}},{default:n(()=>[Ln,o(c,{size:"small",onClick:t[1]||(t[1]=()=>this.$router.push({name:"DebugLocal"}))},{default:n(()=>[Wn]),_:1}),o(u,{style:{width:"100%","margin-top":"1em"},percentage:a.instanceAnnotationCompletionPercentage,format:a.getInstanceProgressBarLabel,type:"line","stroke-width":30,"text-inside":""},null,8,["percentage","format"])]),_:1}),o(h,{style:{width:"100%","margin-top":"3em"}},{default:n(()=>[Tn,o(c,{size:"small",onClick:t[2]||(t[2]=()=>this.$router.push({name:"DebugGlobal"}))},{default:n(()=>[Mn]),_:1}),o(u,{style:{width:"100%","margin-top":"1em"},percentage:a.taskAnnotationCompletionPercentage,format:a.getTaskProgressBarLabel,type:"line","stroke-width":30,"text-inside":""},null,8,["percentage","format"])]),_:1})],64)}var Bn=C($n,[["render",An]]);const Vn={name:"LocalExplanations",components:{ArrowLeft:Pe,ArrowRight:Le,Delete:le},setup(){const e=te(),t=ye(),s=F(),i=Se(),l=H();return{documentStore:e,detailedDocumentStore:t,projectStore:s,localDictionaryStore:i,labelStore:l,TaskTypes:U,getLabelByID:l.getLabelByID}},data(){return{topK:3}},methods:{wordDelete(e){this.localDictionaryStore.deleteWord(e)},wordClick(e,t,s){const i=this.detailedDocumentStore.getDocument.id,l=this.localDictionaryStore.fetchIfExists(i,t,e);l===null?s>=0&&this.localDictionaryStore.addWord(i,{word:t,annotation:e,modification_type:s}):s==-1&&this.wordDelete(l.id)},getColors(e){const t=this.getLabelByID(e);return G[t.color_set].colors},getWordStyle(e,t){const s={padding:"3px 3px 3px 3px",margin:"3px 3px 3px 3px",fontSize:"18px"};if(this.topK>0&&e.order>=this.topK)return s;const i=e.score,l=this.getColors(t);let a=-1;return i<=0?s:(i<=.33?a=0:i<=.66?a=1:i<=1&&(a=2),V(V({},s),l[a]))},getProgressBarLabel(){let e=this.documentStore.getdocumentInfo;return`${e.annotatedDocCount} / ${e.totalDocCount} documents annotated`},goToPrevDoc(){const e=this.documentStore.getdocumentInfo.curDocIndex-1;e==-1?this.documentStore.updateCurPage(this.documentStore.getdocumentInfo.curPage-1).then(()=>{this.documentStore.setCurDocIndex(this.documentStore.getDocuments.length-1),this.detailedDocumentStore.fetchDocument(this.documentStore.getDocuments[this.documentStore.getDocuments.length-1].id)}):(this.documentStore.setCurDocIndex(e),this.detailedDocumentStore.fetchDocument(this.documentStore.getDocuments[e].id))},goToNextDoc(){const e=this.documentStore.getdocumentInfo.curDocIndex+1;this.documentStore.getDocuments.length==e?this.documentStore.updateCurPage(this.documentStore.getdocumentInfo.curPage+1).then(()=>{this.detailedDocumentStore.fetchDocument(this.documentStore.getDocuments[0].id),this.localDictionaryStore.fetchDictionary(this.documentStore.getDocuments[0].id)}):(this.documentStore.setCurDocIndex(e),this.detailedDocumentStore.fetchDocument(this.documentStore.getDocuments[e].id),this.localDictionaryStore.fetchDictionary(this.documentStore.getDocuments[e].id))},noAnnotation(){this.documentStore.markAnnotated().then(()=>{const e=this.documentStore.getdocumentInfo.curDocIndex+1;this.documentStore.getDocuments.length!==e&&this.documentStore.getdocumentInfo.curPage!==this.documentStore.getdocumentInfo.maxPage&&this.goToNextDoc()})},trainDebugModel(){We.train(this.projectStore.getProjectInfo.id)}},computed:{annotationCompletionPercentage:function(){let e=this.documentStore.getdocumentInfo;return e.totalDocCount==0?0:100*e.annotatedDocCount/e.totalDocCount},dictTableData:function(){const e=this.detailedDocumentStore.getDocument.id,t=this.localDictionaryStore.getByDocumentID(e),s=[];if(e===void 0||t===void 0)return s;const i=this.detailedDocumentStore.getDocument.words;for(const l of i){const a=l.id;if(!(a in t))continue;const c=t[a];for(const u in c){const h=c[u].id,m=l.scores[u].score;let f;for(const y of this.detailedDocumentStore.getDocument.annotations)if(y.id==u){f=y.label;break}s.push({id:h,word:l.text,score:{score:m,order:0},label:f,type:c[u].modification_type})}}return s}}},En={style:{display:"flex","align-items":"center","justify-content":"space-between"}},Un={style:{"text-align":"center"}},On={style:{width:"100%"}},zn={key:0,class:"demonstration"},Nn={key:1,class:"demonstration"},Rn=p("Words"),Gn=p("Model Output"),qn={style:{"text-align":"right",margin:"0"}},Qn=p(" add "),Jn=p(" remove "),Hn=p(" reset "),Kn=p("Add"),Zn=p("Remove"),Xn=p("Delete"),Yn=p(" Prev "),er=p(" Next "),tr=p(" Skip (Nothing to Mark Up)"),or=p(" Submit ");function nr(e,t,s,i,l,a){const c=r("el-row"),u=r("el-progress"),h=r("el-slider"),m=r("el-tag"),f=r("el-divider"),y=r("el-button"),w=r("el-popover"),g=r("el-col"),k=r("el-table-column"),I=r("Delete"),x=r("el-icon"),S=r("el-popconfirm"),W=r("el-table"),L=r("el-card"),B=r("ArrowLeft"),oe=r("ArrowRight");return _(),D(T,null,[o(c,{style:{width:"100%"}},{default:n(()=>[o(c,{style:{width:"100%"}},{default:n(()=>[d("div",En,[d("h1",Un," Annotate page ("+P(i.TaskTypes[this.projectStore.task])+") ",1)])]),_:1}),o(c,{style:{width:"100%"}},{default:n(()=>[o(u,{style:{width:"100%"},percentage:a.annotationCompletionPercentage,format:a.getProgressBarLabel,type:"line","stroke-width":30,"text-inside":""},null,8,["percentage","format"]),d("div",On,[l.topK>0?(_(),D("span",zn,"Top "+P(l.topK)+" words",1)):j("",!0),l.topK==0?(_(),D("span",Nn,"All words")):j("",!0),o(h,{modelValue:l.topK,"onUpdate:modelValue":t[0]||(t[0]=$=>l.topK=$),max:this.detailedDocumentStore.getMaxWords},null,8,["modelValue","max"])])]),_:1}),this.detailedDocumentStore.getDocument?(_(),b(L,{key:0,style:{width:"100%","margin-top":"10px"}},{default:n(()=>[o(c,null,{default:n(()=>[o(g,{span:16},{default:n(()=>[o(c,null,{default:n(()=>[o(m,null,{default:n(()=>[Rn]),_:1}),"ground_truth"in this.detailedDocumentStore.getDocument?(_(),b(m,{key:0,style:{"margin-left":"10px"}},{default:n(()=>[p(" Ground truth: "+P(i.getLabelByID(this.detailedDocumentStore.getDocument.ground_truth).text),1)]),_:1})):j("",!0)]),_:1}),o(c,{style:{"line-height":"2","margin-top":"10px"}},{default:n(()=>[d("div",null,[(_(!0),D(T,null,M(this.detailedDocumentStore.getDocument.words,$=>(_(),D("span",{style:{padding:"3px","font-size":"18px"},key:$.id},P($.text),1))),128))])]),_:1}),o(f),(_(!0),D(T,null,M(this.detailedDocumentStore.getDocument.annotations,$=>(_(),b(c,{style:{"margin-top":"10px"},key:$.id},{default:n(()=>[o(c,{style:{width:"100%"}},{default:n(()=>[o(m,{style:{"margin-right":"10px"}},{default:n(()=>[Gn]),_:1}),o(m,null,{default:n(()=>[p("Label: "+P(i.getLabelByID($.label).text),1)]),_:2},1024)]),_:2},1024),o(c,{style:{"line-height":"2","margin-top":"10px"}},{default:n(()=>[d("div",null,[(_(!0),D(T,null,M(this.detailedDocumentStore.getDocument.words,E=>(_(),D("span",{key:E.id,style:Q(a.getWordStyle(E.scores[$.id],$.label))},[o(w,{trigger:"hover",width:"200px"},{reference:n(()=>[d("span",null,P(E.text),1)]),default:n(()=>[d("p",null,P(E.text+": "+E.scores[$.id].score),1),d("div",qn,[o(y,{size:"small",type:"success",onClick:xe=>a.wordClick($.id,E.id,0)},{default:n(()=>[Qn]),_:2},1032,["onClick"]),o(y,{size:"small",type:"primary",onClick:xe=>a.wordClick($.id,E.id,1)},{default:n(()=>[Jn]),_:2},1032,["onClick"]),o(y,{size:"small",type:"info",onClick:xe=>a.wordClick($.id,E.id,-1)},{default:n(()=>[Hn]),_:2},1032,["onClick"])])]),_:2},1024)],4))),128))])]),_:2},1024)]),_:2},1024))),128))]),_:1}),o(g,{span:8},{default:n(()=>[o(W,{data:a.dictTableData,border:"",style:{width:"100%"}},{default:n(()=>[o(k,{label:"Word"},{default:n($=>[d("span",{style:Q(a.getWordStyle($.row.score,$.row.label))},P($.row.word),5)]),_:1}),o(k,{label:"Type"},{default:n($=>[$.row.type==0?(_(),b(m,{key:0,type:"success"},{default:n(()=>[Kn]),_:1})):j("",!0),$.row.type==1?(_(),b(m,{key:1,type:"danger"},{default:n(()=>[Zn]),_:1})):j("",!0)]),_:1}),o(k,{label:"Operations"},{default:n($=>[o(S,{title:"Are you sure?",onConfirm:E=>a.wordDelete($.row.id),style:{"margin-left":"10px"}},{reference:n(()=>[o(y,{size:"small",type:"danger"},{default:n(()=>[o(x,null,{default:n(()=>[o(I)]),_:1}),Xn]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1})]),_:1})):j("",!0),o(c,{style:{"margin-top":"20px",width:"100%"}},{default:n(()=>[o(g,{style:{display:"flex","justify-content":"space-between"}},{default:n(()=>[o(y,{type:"primary",onClick:t[1]||(t[1]=$=>a.goToPrevDoc()),disabled:this.documentStore.getdocumentInfo.curDocIndex===0&&this.documentStore.getdocumentInfo.curPage===1},{default:n(()=>[o(x,null,{default:n(()=>[o(B)]),_:1}),Yn]),_:1},8,["disabled"]),o(y,{type:"primary",onClick:t[2]||(t[2]=$=>a.goToNextDoc()),disabled:this.documentStore.getdocumentInfo.curDocIndex===this.documentStore.getdocumentInfo.documents.length-1&&this.documentStore.getdocumentInfo.curPage===this.documentStore.getdocumentInfo.maxPage},{default:n(()=>[er,o(x,null,{default:n(()=>[o(oe)]),_:1})]),_:1},8,["disabled"])]),_:1})]),_:1}),this.detailedDocumentStore.getDocument?(_(),b(c,{key:1,style:{"margin-top":"10px",width:"100%"}},{default:n(()=>[o(g,{style:{display:"flex","justify-content":"flex-end"}},{default:n(()=>[o(y,{type:"primary",onClick:a.noAnnotation},{default:n(()=>[tr,o(x,null,{default:n(()=>[o(oe)]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1})):j("",!0)]),_:1}),o(c,null,{default:n(()=>[o(y,{type:"primary",onClick:t[3]||(t[3]=$=>a.trainDebugModel())},{default:n(()=>[or]),_:1})]),_:1})],64)}var rr=C(Vn,[["render",nr]]);const lr={name:"GlobalExplanations",components:{ArrowLeft:Pe,ArrowRight:Le},setup(){const e=H(),t=be(),s=ce(),i=F();return{labelStore:e,wordStore:t,globalDictionaryStore:s,projectStore:i,TaskTypes:U,getLabelByID:e.getLabelByID}},computed:{documents:function(){return this.wordStore.getDocuments}},methods:{addWord(e){this.globalDictionaryStore.addWord(this.wordStore.getCurrWord(),e,this.getLabelByID(this.documents[0].ground_truth).id)},getColors(e){const t=this.getLabelByID(e);return G[t.color_set].colors},getWordStyle(e,t){const s={padding:"3px 3px 3px 3px",margin:"3px 3px 3px 3px",fontSize:"18px"},i=e.score,l=this.getColors(t);let a=-1;return i<=0?s:(i<=.33?a=0:i<=.66?a=1:i<=1&&(a=2),V(V({},s),l[a]))},goToPrevWord(){const e=this.wordStore.getWordInfo.curWordIndex-1;e==-1?this.wordStore.updateCurPage(this.wordStore.getWordInfo.curPage-1).then(()=>{this.wordStore.setCurWordIndex(this.wordStore.getWords.length-1),this.wordStore.fetchDocuments()}):(this.wordStore.setCurWordIndex(e),this.wordStore.fetchDocuments())},goToNextWord(){const e=this.wordStore.getWordInfo.curWordIndex+1;this.wordStore.getWords.length==e?this.wordStore.updateCurPage(this.wordStore.getWordInfo.curPage+1).then(()=>{this.wordStore.fetchDocuments()}):(this.wordStore.setCurWordIndex(e),this.wordStore.fetchDocuments())}}},sr={style:{display:"flex","align-items":"center","justify-content":"space-between"}},ir={style:{"text-align":"center"}},ar=p(" Prev "),cr=p(" Next "),dr=p(" Current Word: "),ur={style:{"margin-left":"10px",display:"inline-block"}},_r=p(" add "),pr=p(" remove "),mr=p(" reset ");function hr(e,t,s,i,l,a){const c=r("el-row"),u=r("ArrowLeft"),h=r("el-icon"),m=r("el-button"),f=r("ArrowRight"),y=r("el-col"),w=r("el-tag"),g=r("el-popover"),k=r("el-divider"),I=r("el-card");return _(),b(c,{style:{width:"100%"}},{default:n(()=>[o(c,{style:{width:"100%"}},{default:n(()=>[d("div",sr,[d("h1",ir," Annotate page ("+P(i.TaskTypes[this.projectStore.task])+") ",1)])]),_:1}),i.wordStore.getCurrWord()!==void 0?(_(),b(c,{key:0,style:{"margin-top":"20px",width:"100%"}},{default:n(()=>[o(y,{style:{display:"flex","justify-content":"space-between"}},{default:n(()=>[o(m,{type:"primary",onClick:t[0]||(t[0]=x=>a.goToPrevWord()),disabled:this.wordStore.getWordInfo.curWordIndex===0&&this.wordStore.getWordInfo.curPage===1},{default:n(()=>[o(h,null,{default:n(()=>[o(u)]),_:1}),ar]),_:1},8,["disabled"]),o(m,{type:"primary",onClick:t[1]||(t[1]=x=>a.goToNextWord()),disabled:this.wordStore.getWordInfo.curWordIndex===this.wordStore.getWordInfo.words.length-1&&this.wordStore.getWordInfo.curPage===this.wordStore.getWordInfo.maxPage},{default:n(()=>[cr,o(h,null,{default:n(()=>[o(f)]),_:1})]),_:1},8,["disabled"])]),_:1})]),_:1})):j("",!0),i.wordStore.wordLoaded?(_(),b(I,{key:1,style:{width:"100%","margin-top":"10px"}},{header:n(()=>[d("div",null,[dr,d("b",null,P(this.wordStore.getCurrWord()),1),d("div",ur,[i.globalDictionaryStore.containsWord(i.wordStore.getCurrWord())?j("",!0):(_(),b(m,{key:0,size:"small",type:"success",onClick:t[2]||(t[2]=x=>a.addWord(0))},{default:n(()=>[_r]),_:1})),i.globalDictionaryStore.containsWord(i.wordStore.getCurrWord())?j("",!0):(_(),b(m,{key:1,size:"small",type:"primary",onClick:t[3]||(t[3]=x=>a.addWord(1))},{default:n(()=>[pr]),_:1})),i.globalDictionaryStore.containsWord(i.wordStore.getCurrWord())?(_(),b(m,{key:2,size:"small",type:"info",onClick:t[4]||(t[4]=x=>i.globalDictionaryStore.deleteWord(i.wordStore.getCurrWord()))},{default:n(()=>[mr]),_:1})):j("",!0)])])]),default:n(()=>[(_(!0),D(T,null,M(a.documents,(x,S)=>(_(),b(c,{style:{width:"100%"},key:x.id},{default:n(()=>[(_(!0),D(T,null,M(x.annotations,W=>(_(),b(c,{style:{width:"100%"},key:W.id},{default:n(()=>[o(c,{style:{width:"100%"}},{default:n(()=>[o(w,null,{default:n(()=>[p("Document #"+P(S+1),1)]),_:2},1024),"ground_truth"in x?(_(),b(w,{key:0,style:{"margin-left":"10px"}},{default:n(()=>[p(" Ground truth: "+P(i.getLabelByID(x.ground_truth).text),1)]),_:2},1024)):j("",!0),o(w,{style:{"margin-left":"10px"}},{default:n(()=>[p(" Prediction: "+P(i.getLabelByID(W.label).text),1)]),_:2},1024)]),_:2},1024),o(c,{style:{"line-height":"2","margin-top":"10px"}},{default:n(()=>[d("div",null,[(_(!0),D(T,null,M(x.words,L=>(_(),D("span",{key:L.id,style:Q(a.getWordStyle(L.scores[W.id],W.label))},[o(g,{content:L.text+": "+L.scores[W.id].score,trigger:"hover"},{reference:n(()=>[d("span",{style:Q(L.text===this.wordStore.getCurrWord()?{border:"2px solid black"}:{})},P(L.text),5)]),_:2},1032,["content"])],4))),128))])]),_:2},1024)]),_:2},1024))),128)),o(k)]),_:2},1024))),128))]),_:1})):j("",!0)]),_:1})}var fr=C(lr,[["render",hr]]);const gr={name:"DictionaryOverview",components:{Search:me,Delete:le},setup(){return{dictionaryStore:ce()}},data(){return{searchQuery:""}},watch:{searchQuery:function(e,t){this.dictionaryStore.fetchDictionary(e)}},methods:{indexMethod(e){return e+1},onClick(e,t){this.$router.push({name:"DebugGlobal",query:{q:t.word}})},handleDelete(e,t){this.dictionaryStore.deleteWord(t.word).then(()=>{this.dictionaryStore.fetchDictionary()})}},created(){this.dictionaryStore.fetchDictionary()}},yr={style:{"text-align":"center"}},Sr=d("div",null,[d("h1",null,"Task Dictionary")],-1),br={style:{"align-content":"center"}},xr=["onClick"],Dr=p("Delete");function wr(e,t,s,i,l,a){const c=r("Search"),u=r("el-icon"),h=r("el-input"),m=r("el-table-column"),f=r("Delete"),y=r("el-button"),w=r("el-popconfirm"),g=r("el-table");return _(),D("div",null,[d("div",yr,[Sr,o(h,{modelValue:l.searchQuery,"onUpdate:modelValue":t[0]||(t[0]=k=>l.searchQuery=k),modelModifiers:{lazy:!0,trim:!0},placeholder:"Type to search for words",style:{width:"50%"},clearable:""},{prefix:n(()=>[d("div",br,[o(u,null,{default:n(()=>[o(c)]),_:1})])]),_:1},8,["modelValue"])]),o(g,{data:Array.from(i.dictionaryStore.getRows),stripe:""},{default:n(()=>[o(m,{type:"index",index:a.indexMethod},null,8,["index"]),o(m,{label:"Text",sortable:""},{default:n(k=>[d("p",{onClick:I=>a.onClick(k.$index,k.row),style:{cursor:"pointer"}},P(k.row.word),9,xr)]),_:1}),o(m,{label:"Operations"},{default:n(k=>[o(w,{title:"Are you sure?",onConfirm:I=>a.handleDelete(k.$index,k.row),style:{"margin-left":"10px"}},{reference:n(()=>[o(y,{size:"small",type:"danger"},{default:n(()=>[o(u,null,{default:n(()=>[o(f)]),_:1}),Dr]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])])}var vr=C(gr,[["render",wr]]);const kr={name:"DebugEvaluation",components:{Back:ae,Check:he},setup(){const e=te(),t=ye(),s=H(),i=Se();return{documentStore:e,detailedDocumentStore:t,labelStore:s,localDictionaryStore:i}},created(){const e=[];e.push(this.labelStore.fetchLabels()),e.push(this.documentStore.resetState().then(()=>this.localDictionaryStore.fetchDictionary(this.documentStore.getDocuments[this.documentStore.getdocumentInfo.curDocIndex].id))),Promise.all(e).then(()=>{this.detailedDocumentStore.fetchDocument(this.documentStore.getDocuments[this.documentStore.getdocumentInfo.curDocIndex].id)})},data(){return{exampleInputsForm:{sentence_id:""}}},computed:{getDocText(){return console.log("calling getDocTest"),console.log(this.exampleInputsForm.sentence_id),this.detailedDocumentStore.fetchDocument(this.exampleInputsForm.sentence_id),this.detailedDocumentStore.getDocument}}},Ir=d("h3",null,"Evaluation Section",-1),$r=d("span",null,[p("Model Selected: "),d("b",null,"debugmodel_proj1.h5")],-1),Cr=d("h4",null,"Example Input",-1),jr=d("div",null,[d("h4",{style:{"margin-top":"4em"}},"Attribution scores"),d("div",null,[d("span",null,[d("span",{style:{display:"inline-block",width:"8em","text-align":"left","font-style":"italic"}},"Original"),p(": All muslims are terrorists and need to be deported from this country")])]),d("div",null,[d("span",null,[d("span",{style:{display:"inline-block",width:"8rem","text-align":"left","font-style":"italic"}},"Debugged Text"),p(": All muslims are terrorists and need to be deported from this country")])])],-1),Fr={key:0};function Pr(e,t,s,i,l,a){const c=r("el-divider"),u=r("el-option"),h=r("el-select"),m=r("el-form-item"),f=r("el-form"),y=r("el-row"),w=r("el-card");return _(),b(y,{style:{width:"100%"}},{default:n(()=>[o(w,{style:{width:"100%"}},{header:n(()=>[Ir]),default:n(()=>[o(y,null,{default:n(()=>[$r,o(c),Cr,o(f,{model:l.exampleInputsForm,size:"large",style:{width:"100%"}},{default:n(()=>[o(m,null,{default:n(()=>[o(h,{modelValue:l.exampleInputsForm.sentence_id,"onUpdate:modelValue":t[0]||(t[0]=g=>l.exampleInputsForm.sentence_id=g),placeholder:"Select a Sentence",size:"large",style:{width:"100%"}},{default:n(()=>[(_(!0),D(T,null,M(i.documentStore.getDocuments,g=>(_(),b(u,{key:g.id,label:g.text,value:g.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),jr,l.exampleInputsForm.sentence_id?(_(),D("div",Fr)):j("",!0)]),_:1})]),_:1})]),_:1})}var Lr=C(kr,[["render",Pr]]),re={updateToken(e){v.defaults.headers.Authorization=`Bearer ${e}`},login(e,t,s=!1){const i=z();return v.post("token/",{username:e,password:t,rememberMe:s}).then(l=>(l.token=l.access,delete l.access,i.login(Z(V({},l),{username:e})),l))},refreshToken(){const e=z();return v.post("token/refresh/",{token:e.token}).then(t=>{e.updateToken(t.token)})}};const Wr={name:"LoginPage",components:{UserFilled:Xe,Lock:Ye},data(){return{loginForm:{username:"",password:"",rememberMe:!1},rules:{username:[{required:!0,message:"Please input username",trigger:"blur"}],password:[{required:!0,message:"Please input password",trigger:"blur"}]},isLoading:!1,isValid:!1,showLoginFailed:"none"}},methods:{login(){this.$refs.loginForm.validate(e=>{if(e)this.isLoading=!0,this.showLoginFailed="none",re.login(this.loginForm.username,this.loginForm.password,this.loginForm.rememberMe).catch(()=>{this.isLoading=!1,this.showLoginFailed=""});else return!1})}}},Tr=e=>(N("data-v-081151ca"),e=e(),R(),e),Mr={style:{display:"flex","justify-content":"center"}},Ar=p(" Login "),Br=Tr(()=>d("div",{style:{display:"flex","justify-content":"center"}},[d("p",null,"test ID: test / password: test")],-1));function Vr(e,t,s,i,l,a){const c=r("el-alert"),u=r("UserFilled"),h=r("el-icon"),m=r("el-input"),f=r("el-form-item"),y=r("Lock"),w=r("el-checkbox"),g=r("el-button"),k=r("el-form"),I=r("el-col"),x=se("loading");return _(),D(T,null,[d("div",Mr,[ie((_(),b(I,{span:6},{default:n(()=>[o(c,{title:"Invalid username/password",type:"error","show-icon":"",style:Q({display:l.showLoginFailed})},null,8,["style"]),o(k,{model:l.loginForm,rules:l.rules,ref:"loginForm"},{default:n(()=>[o(f,{label:"Username",prop:"username",class:"bold-label"},{default:n(()=>[o(m,{modelValue:l.loginForm.username,"onUpdate:modelValue":t[0]||(t[0]=S=>l.loginForm.username=S)},{prefix:n(()=>[o(h,null,{default:n(()=>[o(u)]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(f,{label:"Password",prop:"password",class:"bold-label"},{default:n(()=>[o(m,{type:"password",modelValue:l.loginForm.password,"onUpdate:modelValue":t[1]||(t[1]=S=>l.loginForm.password=S)},{prefix:n(()=>[o(h,null,{default:n(()=>[o(y)]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(f,null,{default:n(()=>[o(w,{label:"Remember me",modelValue:l.loginForm.rememberMe,"onUpdate:modelValue":t[2]||(t[2]=S=>l.loginForm.rememberMe=S)},null,8,["modelValue"])]),_:1}),o(f,null,{default:n(()=>[o(g,{type:"primary",onClick:a.login,disabled:this.isValid,style:{width:"100%"}},{default:n(()=>[Ar]),_:1},8,["onClick","disabled"])]),_:1})]),_:1},8,["model","rules"])]),_:1})),[[x,l.isLoading]])]),Br],64)}var Er=C(Wr,[["render",Vr],["__scopeId","data-v-081151ca"]]);const Ur={name:"LogoutPage",setup(){return{userStore:z()}},created(){this.userStore.logout()}};function Or(e,t,s,i,l,a){return _(),D("div")}var zr=C(Ur,[["render",Or]]);const Y=et({history:tt("/"),routes:[{path:"/",name:"Home",component:mt},{path:"/projects",name:"Projects",component:$t},{path:"/login",name:"Login",component:Er},{path:"/logout",component:zr},{path:"/project/",component:Ot,children:[{path:"doc/",component:Rt,children:[{path:"upload",name:"DocumentUpload",component:$o},{path:"list",name:"DocumentList",component:Zt},{path:"model",name:"ModelUpload",component:Ao}]},{path:"labels",name:"Labels",component:Ro},{path:"generate-explanations",name:"GenerateExplanations",component:Ko},{path:"export",name:"ExportData",component:tn}]},{path:"/debug/",component:In,children:[{path:"overview",name:"DebugOverview",component:Bn},{path:"dictionary",name:"DebugDictionary",component:vr},{path:"local",name:"DebugLocal",component:rr},{path:"global",name:"DebugGlobal",component:fr},{path:"evaluation",name:"DebugEvaluation",component:Lr}]}]});Y.beforeEach((e,t,s)=>{!z().isLoggedIn&&e.name!=="Login"&&e.name!=="Home"?s("/login"):(e.name=="Login",s())});Y.afterEach(()=>{const e=z();e.isLoggedIn&&e.inspectToken()});const z=O({id:"user",presist:!0,state:()=>({userInfo:null}),getters:{username:e=>e.userInfo.username,token:e=>e.userInfo.token,isLoggedIn:e=>e.userInfo!==null},actions:{login(e){this.userInfo=e,re.updateToken(e.token),Y.push({name:"Projects"}).then(t=>t)},logout(){this.userInfo=null,Y.push("/").then(e=>e)},updateToken(e){this.userInfo.token=e,re.updateToken(e)},inspectToken(){const e=this.userInfo.token;if(e){const t=ot(e),s=t.exp,i=t.orig_iat;s<Date.now()/1e3?this.logout():s-Date.now()/1e3<1800&&Date.now()/1e3-i<628200&&re.refreshToken()}}}});var Nr="/assets/logo.4941f0a9.png";const Rr={name:"NavBar",components:{},setup(){return{userStore:z(),Logo:Nr}},methods:{loginClicked(){this.userStore.isLoggedIn?this.$router.push("/login"):this.$router.push("/logout")}}},Gr=p(" Projects ");function qr(e,t,s,i,l,a){const c=r("el-image"),u=r("el-menu-item"),h=r("el-button"),m=r("el-menu");return _(),b(m,{"default-active":e.$route.path,mode:"horizontal",router:!0},{default:n(()=>[o(u,{index:"/"},{default:n(()=>[o(c,{src:i.Logo,style:{width:"58px",height:"58px"}},null,8,["src"])]),_:1}),i.userStore.isLoggedIn?(_(),b(u,{key:0,index:"/projects"},{default:n(()=>[Gr]),_:1})):j("",!0),o(u,{index:i.userStore.isLoggedIn?"/logout":"/login",class:"dock-right"},{default:n(()=>[o(h,{onClick:t[0]||(t[0]=f=>a.loginClicked(f)),jest:"logBtn"},{default:n(()=>[p(P(this.userStore.isLoggedIn?"Logout":"Login"),1)]),_:1})]),_:1},8,["index"])]),_:1},8,["default-active"])}var Qr=C(Rr,[["render",qr],["__scopeId","data-v-3fc15066"]]);const Jr={components:{NavBar:Qr}},Hr={id:"app"};function Kr(e,t,s,i,l,a){const c=r("NavBar"),u=r("router-view");return _(),D("div",Hr,[o(c,{style:{width:"100%"}}),o(u)])}var Zr=C(Jr,[["render",Kr]]);const K=nt(Zr);K.use(rt);K.provide("$api",v);K.use(lt,{locale:st});const Te=it();Te.use(at);K.use(Te);K.use(Y);K.mount("#app");
